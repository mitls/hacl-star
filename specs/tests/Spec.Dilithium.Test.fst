module Spec.Dilithium.Test

open FStar.All
open FStar.Mul
open Lib.IntTypes
open Lib.Sequence
open Lib.ByteSequence
open Lib.RawIntTypes

open Spec.Dilithium.NTT
open Spec.Dilithium.Packing
open Spec.Dilithium.Params
open Spec.Dilithium.Poly
open Spec.Dilithium.Stream
open Spec.Dilithium.Signing
open Spec.Dilithium.Verify

open Lib.LoopCombinators
open Lib.PrintSequence

open FStar.Char
module S = FStar.String

module SHA3 = Spec.SHA3


(*************************************************************************)


let int_of_hexchar c : (n:nat{n < 16}) =
  let x = int_of_char c in
  if (int_of_char '0') <= x && x <= (int_of_char '9')
    then x - int_of_char '0'
  else if int_of_char 'a' <= x && x <= int_of_char 'f'
    then 10 + x - int_of_char 'a'
  else if int_of_char 'A' <= x && x <= int_of_char 'F'
    then 10 + x - int_of_char 'A'
  else 0

// the previous function breaks VS code syntax highlighting, these two lines are just to unbreak it
let _ =
'a'

let rec bytelist_of_hexcharlist (len: nat) (clst: list char {FStar.List.Tot.length clst = len}) :
  Tot (ls: list uint8 {FStar.List.Tot.length ls = len / 2}) (decreases len) =
  match clst with
  | a :: b :: tail -> (assert (len >= 2);
    u8 ((int_of_hexchar a) * 16 + (int_of_hexchar b)) :: bytelist_of_hexcharlist (len-2) tail)
  | _ -> []


(* takes hex string *)
let lbytes_of_str (s:string {S.length s < 99999}) : (lbytes (S.length s / 2)) =
  of_list (bytelist_of_hexcharlist (S.length s) (S.list_of_string s))


let test0_mlen = 33
let test0_msg_str = "D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8"
let test0_pk_str = "7C9935A0B07694AA0C6D10E4DB6B1ADD2FD81A25CCB148032DCD739936737F2D2F4F8FABA268F4304160EEAE093D9C539F7A9E872C5B92C85581253EBF8DF0CE453A1012702FF50FD3C6D20E41A44F1A1F5C0393C7DECA45321ECB9EBDCA30329898D579C33756AAF76CE77D3543FD45945BF334766AF01926781F4034AB54AC6F7E0B902D17C9C209016788386D13A5163E4D3A7278971F71011DA9E4147F59BFBA7185A1D91B6B90E357D44FD2F330E459971967C3567A9CE229B6F03B43F1A78AD086BB47C084406899DC25B14D2CD2BAD6FFF71E4DD284FC52EECEA00496AE1B8A3B6071F4F9052A01ABD009C3D642E74221026165635EE70B81DC153C693CE63E69A051EBC4F8B57EA55F48A97254532EDA16F2AB90B1F8BB22FBF0364AA6AB7D8AC1FF84E48EB58B26C6743FAA0884E4733D4052F10A97E65CFFC209DAB18E55935C0D216C2D1F1B1DF8786FFBA842C5F2E2AFB60199777B8896A0DA28BB277CA0AC09C2585B11B6548AB897228DE43AD50563207AD55D7AB94730DD9C7805E409CBF67B9A591F8FDD8B4214071E5FA7BEA20594F3D8AF4E1E7605C228CC2D2AED226B92D50AADFB8439BFF3C9B477CD833935B9C4AC4738DF186492B58E03589E3BC418F203D1ACAE047B877330F5F7FAAD662319265684C5E53D18B941E2354334BB39098166D5E484F1783FA0E104147B47686F3869F13157F84321264A6E3A843041E11D9BF90166223109E1490928D8407A91CAA3111FB5A9C49B16943C0E48780D9406188D9808318BCA9736A02F781F995BD5F0520C9F3733E10DA420814ACE11F7F54B739674A920CB81C9D3A2C136576D4D5FF6B904D6E2801DD9BE45D9B1CC52E3D060BF58B04C78B52036DCBF41A3F6D9CD8B50443106EDA8D18A14059618649B0F899642A8BDEB2669E90F4077D2FF84703600649F1BC0B6FAF5A687EF96432FB759B01F76DD6075946BE66DC6831A265AF2BDB0C0D9192DC66EB6A47D54A396AD67D2A6A065FA9F2600F304DC5E1428BE154D6D6009BB09DE42953B128E1117F1684D44B8ED6537C1F55F81ED39E355500FF91DC5C51FFCB0CBD3D054AA39ADD29F79C39F246D2BFDC4FC2D0B82B4A2FFAEBB58793508D03568DB1DCADC4D4D21F9D5AD87499F603C352C60762E01F5D16E960B70333D65884A9444F5A64D475D0900AF4912D4674E40A617E75C21171AE63CF81D46C8E15185899DED8462F460F654DAB1601F2B38FDDAE0431044379F57CC7370AC5910D66BF7C8C9A482BDBBFE457C6658BBEDE885F2EDEF21F2B30164C5C326616758A8D2C6F7981CB406578DDEEF5D137C69BBAE88A8304C412A2A42A1D07A981342E34118AF1BD6E3671B1EFCED77F164552A388ABB9A53A378B9ED72CFDD35A4BB8CE60BFE757AEC5EB38A1148CF8852778E1D17EC09FB99F1CAA898DF8E44D6C666EE8AB91622E7CA3483A93EAD60FB86AFED66D5989FC8BE4E95ECCD83E0F4A9BE20CD2CF7318C2D717CA677160CDAFACF686B1E5303D9E8F2E424A6993331E29487879933670ECF533CBEEEC370E29A9CF8525A754550DEBD91AB754E6FE0C21044A4C20CEB7515E61908E2F67FB12C89A091B56594B5E17FC0B74FE46523E12B0E3A5849D0EEB05AD0CEE8DFB62EBD2CF333A6E146D2CECCA2C791CF21F2D6E2842B4E599BFBC50EE479C929DAF97ED4CFA55A127ABAB621C7236B5A2621E98B7B5E70ACB6AAC2D67DBA314000BA3010889DF20A799FCEA1BAFDE2D992C4D222AA94F5A3EDF65439ED6544E42EC9E5E4D4F086243B50D00E6A17E778DAEF618DA339C48585953CBECF47F33B2C64DF968B6CC7AB75547E291F69EAD45D36B1AD8F13FA49F3D823FF5E9358D6C009A1CCD98E3CBFC9596CB979ACF28347BF165D0A18A2A9AC979EDA93CDEF6469BAA54F072DFA023D0A08594D7BEB10B0D6E7213AC08E470D0F52C63BB2B2D5E23AC5B4CC8BAD8589378DA67D7DE1B394FAF5A624112A0A7317B63BA331C645BCD78FAB3C374496CC0148E454392F0A82C8C94800824A1A7CC577A407D3830C495541D07B2586B581F3F1F3708187D34610"
let test0_sk_str = "7C9935A0B07694AA0C6D10E4DB6B1ADD2FD81A25CCB148032DCD739936737F2D3E784CCB7EBCDCFD45542B7F6AF778742E0F4479175084AA488B3B74340678AA8EBAFDDFE871ABA84291DB726D9F129174454F5FC0DB3A12E77361CD504017A9F4F32E8624129F2D1B61B66820AE1C27495233996505260189A40292341053460049AA633085A816A00A36109018514946488668034A9492A5470974239735A486A2924171788A0A10A628898680249972317915555430A775A8939248247597A265966987551016579346691682A6606375568276880373087761786140461418A460554063898296A890A4A00263197421023A140909AA89309A87713815577A1A3400430050181853745923128990A14181918854863862520755185030396897A177048320302676A8077459A1204070A141677A054A3831672630645036856056A353A634525430058134A60623199958646A96995A20658007041431527A378403860702416484041049535A128517807059576A16462395200A7261858A7963074098848836017625A13A27418524896821851724845816531923623103802089921AA6863A97660254733230142A32472632909A304386A200648169784613248600A1A6A730577739548A6588591874686881077531726A39794692960905A017284AA02775346710108163625A50A57635614579034241982A0A7484830970AA09892077A3476166857183063221074530321440338A6A87301A79A1885A564479059A87750334019401524223620794965700A256244495478579382A2311A4A27998A22A0881769928557884944085A8034627388220235222505079312370955A26105844718077697882622452787117942A44998867A12252668304A23322665949383707920A23217039775A914214483373AA93683A26AAA6348241744754A99839A40A64644658A7625004718021694818A371387374AAA913A09495AA9581528AA977030412879A1A24945A367284A1963746A7564500025821750686611780341298166469354434A22A51711533075A306523637994314749611089471A449AA383826914381205266550485642051103941862769660232A9630A43207672050728912835A30421A07273062772881730150410946699043071215A092242912A45A7490196980572445A58564804427546023011869A33635A1757340798863926A27307879106715189822AA63910051AA651A94571586AA5359AA2266401107871011A36A5A87293641874232182716A373932016425A03491A2144071936198AA8285258161A9421604008199530267201130285326904039880562A62147A97370602A226AA8A73670704899A09A07355637321A1A2641773299A167965A561464516090A4862A97A206A1AA639060864A8897033166730885590836A992372692309235449063023A88A214A4660AA9224160886A42385949681021952A25961684425250136947A46865030376856A204011A035066441362A32A44371721096A17A08786A9188886A590690078026802095A5517A29493656900171A406AA952910945761541A935148058789759119602433624794969872069A943109A3690182A4547310644330316867522359312A241A8220A4636AA352527A060A78962910653380816768798330204400824972A0929676A36997297268206963395691AA963743A04A47A5288A716339526439991477962419633A8017A0A38191700314AB99CCDBF53E9020EDE4D0FBE45CDA2EED4850A4BE727E0136010DA01D6890D7D1189E08B9D98327A76C496BBA2A8805B9DA55DA7607539BBD16579070BD513D2FA830682A9D0DBFE50FC225294DC08922A24807B3E7A22BB52E8FBBD9E556081B2C473EFEB452FC07375A08BD4D285E5469D9C93487B9ECD7057DA016F27A1FCFCAC13B196285EE10506A2D46601185B284900671C29992C3D4AE23E603B723BBDDDA4746C4322AC43CE1F58280D66B42227FEE12E5851955F3D8DC61814013B10B1D859C5E1BBAC80326777DCCB9F994AC7278F9CDDA2F27438C2ACC0590AEC332096FE0FEF88EBD5CB71750E2737FBFEEDCCF56A5079D34A5488BDF3D141FA9E87EC3917650E4A85E76DC261EE1E4FFEC9F014940A0BA62D3A9BF8EE0513290F072F0CD855345C0F790417AD701000218755DC00DB37CAE6FE198757AD6B049631F29B7C46C5E63B80F49E48CDC3EC827FEF8E74D96DB18B0FDC78CE756F155CD07992CEF2E833C6CC3F6EEFC50DFBA0914554A40C5E85849FF5E4D79B9DE12353AE504A3592995E4EDF1F3E6D768D15BF1EA9CB4A44B69FF451BB4E796257EEBB176F919BD82922CD7DB1EE784B304C52BBBE1854EAD923E5C51A34CE2322AB7185C9920F955B9CF88417B9792FB2FED46440A973A1711B4C5C39ADA26456943559EF7EBA0957EE1FB8E4EBE2A269009AF5662D53C00CFC851E9AE760D861F7E87C53A8B27E679CCC583951E3DEF37C81A4D3BC43A6EC7BF9A15E7371ED7DC974C743F17F02B4561F32E590277D54C5A0907900693C78CFD450B2D0AFE8CE55B8300FA98B88C7E207D131B97BEA31A1C444A9881A14943E256059194DF3D03F8D07EF3271911C7E8A04FE30542EF7AD3B6A4D0AE7FA5B84ECE3A30572257C3513072221D0FD8B999CBA0B1719FE9A28766615F5069627FC198D6A819856D8E13EA76A18D4584E2B3983ED97583EB694E65B2867C5DD1CBA79D90D6CC86B9C2B6E1793EE73856597733A3639DDD327A375C7691D339476E45BB575F505A99F22F0E6AAF6702EBC99C28A659EF667306824D6C969CCB6248990ACBCF22A6E0E18C55BE47A1B2F407B56F2BC5F34BD0C47A0499EC80AEBF89F8BE0A41F506E5194D04B92B02FA69635362AE1983DCFADA43D90C0DDACAAFCF31687B81CDD712BF4CDE1BB36BD4390FB0980A2047CDFBC945ACD7E61165A37E1F10641AD062A90DC1BDD4B83094220728A749464046579500C6B655693B2616BADA36938D6B11CFD07D0970579C064741C398BC8D81703ED1B3674609A788276205369595807B1B4AAA539008310BF8B3FD75B3BB105A28C2D38764F4C84875BC2D53B5BE30A80171BF3F1EE62B07BD1541B75501556F5A40A5FAE0939E47A9F08E8B2A5EA151E17F469EE9D1DF162390DC70684D541F98C128DD080BF68291AE107E5005A1FFC69E399291AAF0F3599F481C9FF2B8990351D5B9076BE7C5C49F8872515EC9BB4ACF0C5F723E15E3C9CE63FD7A38F4F81CF5B795C841B7E76302C4502D6B9FB9EB32000B3CD8911FC0D73627AD61946F3D32444D299DA1CD79DFCC69541A05C90D425C9F50E91A1F8D67C86B69B36BA73113DB1560FA7133B5A91FBA63A71AC4F413999E49EE400340AD7735E09E1FA6B91F4F62BDD773ADEB491767F8C3DBB5C47898687603FCA40F717DC91F5C6CCD81F98740EB8087E7083A08254138F44A477E9A5670E6082E8843DAC8050DEC1457C3B7E75337637FB3D3A1FE6200EB77B3D0FE351256A709EA77F545CF081180CC58BF030BF536077B650083E811D1866B3E2E3D5EC451123CB73D700F98ED5981E30B506F8542DA8F22CA70887912DFC06EE1397BE1F64E0475513E0E486D85C1E77C045A3286AEA26423A6B178B2ED968E44534A9239DA10385144A24337C76AA66F54D1354B37097A7A0C5EC3C96D69EC08EC8F62A039DFC6E9A3A8B77DC086530FC8D9CD895795664A4AAF3994C391282A41274ACBC4B6DEE85695115D20F7275E09A8E57508DE27278C47CB25558E26CA7CEA390492ABCCF4980FA7B43DD230306E9E58420B5CB9AB6BBEFC0762D221C86BAADA78E3FC5A4EBD418C94ABC001049DAAD7F132E23796197ABA484118D0A5FD04B7843E507263E4A0C968513FB87E02DA811BDD7529586BAD891717DD307682ACC44C8FD3156CD52240F6CAA8CD6ED7B2D4AB6A0A66399EAECF0D76C6650BDF5053A7FC8D43CABC4A1ECB5BFCD4857D47CA0BFE7570A27A19B608D4C955A23019B47D0DBA1B6D21F481F026AB4999538F1665EB6F6E6D62135B36BF75014AB0A28BBAEBCD0C9C0B929DDBD86C224991062DD9BCAF8D84A4A8CEE1192922652DE1CCAD11339CB49C81E44948B92BE173B60A08EA9F8C4AA1FA0A208DC915B1FD2F9DA63CCB990397F41B72F964F1ED31C4A50CAAD02D66E8C4A9BE403CDA4AC0E1274EB7F3589C49327EC0AF71DAD54D1B56DBB1641BD52737E786619715FE4BB14159D8668DC06261806F2C9271E2C0F68950853844FF3CBC9139FBAFACFF12F5041F61D9BA7C0A0242B5666D1AB8095778A4FE6442B2430ABE84D6C0A3735AD3A2EAFAE710467DA963D551452740F96A0816CE5630637911EF7A6E6E1039FD008166E135C2753F5AD3AF69B899CD326FFE5B385E4420DF1B33E251A13026B75DA558C85F740A7B55AE7335F1CAA711E648A1B5AE7DC546271BB4C4470DB79B883A280C5C5CC0ABD880ACDE7A6F32C15CA6FC31B1E98E70E3C9D93F4EC5FFA91F1C1837837CC715DC8A3E5037C1936DB2880A8A74E3431062A9328841046067A20C71D9C03864376C10B0BAD132D7656FB02C62BDD72B9B2B0270FCD0680BA539398792EB11BD84F7D283D2C3295C34493B0E406566E1D1107090D7C0D46C6C9A6CA0B734AB6B1AB11D1E944DA0E06932BD9A2FF114B0AA6963D88BD0AFF31E320B89C82DDA8DDE23C91E28E68616E916570AC7DEA75ADD5A8E6F67F08229411E2AC6D85D42F05E79BFE430629344120922C1130FFC44EE6380EB5AA9C53E0501F905988BCB61294EEF2860BF139442E492F7808FCD7A869CE11979A91346A206F05A58B7164C93983619BAB9D3B382C83B12DA778D9E9739D372D83F727A4AC7DD264C4E2B92FDC06C3C3D53A2EB0ED34DD47D7A21553F76D5067"
let test0_smlen = 2734
let test0_sm_str = "F21B63C5CB868F1932B5D92B34758845E0123E40F7987C10643C3420D352BB2CFFC0BC3B1ADBD774D150EE4580537B06057D115D12E6331A10D3B31A5ED370D7368D566798B4C4E6725602B39AB1548F7772D985892A901907A8E9D6C6C1B55207ECD8A30F1E2965A171E121CD94D26F8447A89B2F3BC555CB87F9E22FB112DD63A565B4E289B420099B24F5E4F8F3778D49CDAB369BA335B3609A0D40AE746B7749955DE80BA51779AC91EAC7E6595D1F82C263DAC3A5945C05D642A19BDEC0E833D99C8AED9CE1979B1018103D6990DAB520D52C946B246F07E8DC6285DC510F1353A04EEC62607970841BEAED9BB83A367FCCF0145DCF522F7CB2E633665AEED8D5DECA872C9F7E78EECDDFD6EAC3AD2FC372AEBED4C33E7D6371A1D99154937568CF7E4C7249A5DC9E62EC3508C489C83F5448C72C44FDE4F86234D9419749FB561E5449E1751FF1C4EB4D148132C2931E14B29E30397B81475BFBCC9B93F659EDF395691E69A8CBDFAFB1DDD6692481973EB11601F6122EBEA9D44B845A1F4EF84D177854E0E73234C7161923845AAEC5E5B5603317DDC26492B6392E8B5A954AAD539B3F215D37242BFC48BD99ED17D767F8590F4D31C85664732E4ABDEA1EB4E6CF9056F1332A232EBC95F5F5F306D6EA867D223F2B7CE135C54E133579DA4E08321A8AEC905AA586095DF7AE2FEB9D37F7455F3E1C2C04F0CF47F29428664EB0F100E015A71D97ED40D9D8E4F36BAFB152872CFE42DBDB3494420E9023F40A5831695C02BF15999E636A3592D07AB63F5C91E8353F33FDE10BCA5464026E0A8A18FE72AA533263A4DAE0094BE6CA57C5901E0EC4F94AB41F607A42076067AA760E19AB4593FF503A0DC4097B671835905EA10E8274DF89687ED185D048688935F4187752D2122CC1E7D45B4CB5B6DC54F7BA98AC73D717BA3DA1B25E95A78AFF6014D355F614BE753CD921AD2D3F4C8AE146030B79AEA094F8B169259280EB39FFD4E358E144197EB352AA230BB4A2DA8CE961FC2F85F2C60794B335D4888E9DD476A70472AB263057DBA8CBB1F69BCAC15C1E99DFEB3E3748C1206589116FC6E762C59F661AFDD0D6FAF1F7735C68E18CBF340C949F382C070BFF3DAD1C40291A400CA01199FCF1DDFE3DEBB18C9E8E2D7F578B2E412F7A71439B9EC54ED15B640E3B92D3DCD7F377A4BCDAA43104713D405C7825AFFA46AAF43FECC01D73362138213FEE17C68EF7AA9B5AC6E414A49641AC2C7775E299D51861F1C57C9B66687DC0BB7E3E4D4EB110D6D29C59B1DE07EB68EE4DDD02884719D7B4C1D9C5064DB743EC4E85859CC391DA78737969C040D8F0B0ACBD6A4B2B31F6622834E3D20E721147F49CE5129EFA45F8EE800B3A23CF4CF14C61F6C79AD35B1D04B503AC678825481F26EF4C9A5041A9AFAA1925228A41C6B94ABB5833B356299621E0EA368932784BC8F55F860963928C07F454350E43926BF68F1CE330409A9D0C288F1276FDA7D13020A2930358A6EC6425DD93188256B0DC2F55E69F30F3631E9BE7086B02BB2B40F5ED670ECC96B31E3A4B5B1B84288BE0EDE0B2FEF33BB017B7941D5F2109D1958C5EA5F6259551A44C94B157EEE065FA369DEF66B88C8200B6919FD7B029C7DB6BF11A0884AF868EE5097796A39789C64DFFD55288917F0F3E81F507C2B9869E80074AD288F15968F7A60492B3647D2B0D9FD367B1F7BD082F545A263A76E2E0667EE76C844FD8A2F4E4E07EBF88D3FEFD355B888867EFE94EB2A0B231489C07FFBE204451B45709E012B47590D9770B22E23FE7CB02430466FA08A1CFF9FBECD6A8C6FF7CDA75C10C121B06E88F4DD0BF42BB96EA58AFAA087028050C3CC10FD3575CB0F7B85EE8B5A0B4F1F8798FDB493EEE3FA942DFB21585ECE878E3C433337BD6C93FB4B98EA24C4CE10A92254952220B4C7281E5C4381D53CCD20D18F45C51A661FDB2D3312B79B85E3E07A0DE6646855872C815038CFC2887B0E48417175CD781D4E358778A3E8BAAA2BE570E1B93349F70123E0332B70C6C1811867485D2F321BF41674AC91688880D36BA4D1A8A0C89C8A2D7F204B4809EA1CD137F0DB45CE1B17247F7C6A68BF9736F561FA3A86440AF1E520CE8ABCD40BA68D796C2EF57B1DFB2105A84C604DF0B93FED3E1E662A495BCE63B51E8349E58D191B2E527E0F8F04CD75CB475291F3AF974D1239AE146D292338F5F320F3541159CC8D3A1D87D20D5790808595F12626030A497091DD2D53AF680B16599D91B111BFB97FA95FD5B3FEEA0682AF563D5962DCC70132FDE4889ED1CA30FCC65EB1F326360528C0F0408C40722DF988C58B6B8A5EC596AB9CB87689BBBD5F7D7A4D00031586D6D748B601A957BCA8E07939FBE70BA777382311F4F34A584B0851CEFE2BD660E32A232866DF1EF1461CBA9FF3F38B1F81443DC3DA352B835743CB7CBAFB499F497BB1C9D7A5E94EDD028EE8F118AD75BDC09650D04FB4DD249B931E006AF78C280BD2A6A7254735758EAC8DF3AA7B9354656D9C5A0379F5508D4B5FD0C975D00623AFF22AD79AB9BC2BACB8444B59BBC1369EE8E481C4E6E17A539869277114086FB4501292C1B739777F4EBF133BF02ADE2CFB53BFFE94358CEC5F3F1D6443AC849ADC78969556DF43FD41ADAEA15139C2411860487AFA0109872E912BFE1DEFF84F6F372F4D63B2C09E1B944898601BAA48628C4E64D7B5AB419F6409C6874D0697472F4A925F2869130BB09D105514DFDC48EE5C8D2598B867A38C959E79CE2323FA5042B0C9FC0A85021C933ECC4AE071F942D8FAE5610A44DE177644117F160BFC66306C418273FDB41D695B569B17CB79F96317D0BA86F789282C6629EAD3D031840F2731D090AFB611335BB5D4FEBAB9B7508F4EB555B82F7F5E892ABB3EBE72E84B6B837E228CAB77B268837CAED768DF367E9057201C1059CF5DEE84B3B280E71CBDB087C7391B4D9FBD0B9927B1FCB5D590CA8F7B1BF0BA75862D38ED3A5D3825C9600E55BD5EC54D34ECDDE23B3398EFAED143E31658D820181566AE658A41FB9286EE39BDFB13DD427037D67C1D41888FBD0E7799974D776C0123CC7D77DBDD1C9CCD9AB827C042AC52E1014CC87452780DD6D2CD3B98EDB688D6980EC454FBA5F8DE9A32EA313F7547495921B7F5E29078751C1F7C777C53543003103501F9CE50DEFCA040A592858EF9A87B314060465FC99007AA8BAF2194A9385DD8F165071BC2636CE33BAEF71D19DDD3FDDAD96C197F9245540FE1778C9CE4506A990D21805712EB91EE5C8ED84EB27ADE8A1E2E1261C6AD7CEDDCF17097E2B87544096AA9642F8B9D2E28D5DA7A344F58F0FF77532E30E41F25AE98E022E15A654C775914198A5FF2E7A7216B6AC733E2B498DDD533CA2D779878B2A27D5194FB445EE28FAC9206BF0142365CA403453B074896EE6706151EB706948D8D1C5795E595384E66545146D0865CCEF3BD43C43C45ABC3AF288A664BFB6D49D1A4705F7CBBE796E72230E085AD6C90367B9B9E02E4228A65B2B6F50E66669D5E3A0AC47B3B618571409AFE7A0AA1503971F85549594BD165F5F25289B648768F0C15A365B815A894240CF2A9607852C62A835B8010616191C48496A6E929FA0B2CBD1D2E622232F353C4A51585A5C647291A3ACBDC1E5EAEE04132930315C6676ACD4D8DBE80D13182228343C42477C87909AA8C8E5EE0215161935454650718690969CABBFC3CCD5E8E900000000000000000011253243570D1420A265006023101014006A50808010011830D00804524095000006C64243BADBDC8E1C015A0DD81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8"

let test0_message: lbytes test0_mlen = assert_norm (S.length test0_msg_str = 2 * test0_mlen); lbytes_of_str test0_msg_str
let test0_sk = assert_norm (S.length test0_sk_str = 2 * skbytes); lbytes_of_str test0_sk_str
let test0_pk = assert_norm (S.length test0_pk_str = 2 * pkbytes); lbytes_of_str test0_pk_str
let test0_sm = assert_norm (S.length test0_sm_str = 2 * test0_smlen); lbytes_of_str test0_sm_str

let test1_mlen = 66
let test1_msg_str = "225D5CE2CEAC61930A07503FB59F7C2F936A3E075481DA3CA299A80F8C5DF9223A073E7B90E02EBF98CA2227EBA38C1AB2568209E46DBA961869C6F83983B17DCD49"
let test1_pk_str = "4B622DE1350119C45A9F2E2EF3DC5DF50A759D138CDFBD64C81CC7CC2F5133458283B00ECA791F88BDC8F65EF7A57365253BDAC5C8C2CFAC5BDB2DF99E184B24A5B77A03DEA7AE267A176B682DBDA59847BDCF1DCB5BC70045D706E18E3D993B834B217C42960C32F40667D160F880B526188F3D41614D2211284A36E060F0D463FE7C1430F5CA59BCD95DA6FDFFA8275728F4FFCAD6F8B7FBBA7E35961E5176CD817E53FA7B5FBB8F5878305B01DF10B1B5096A3FF94F5F42E1B9A4D9A4B2DEB7235E5F569DD8D9BC52D51678B5DC9D55BEB07DC0AB6901F59283B1C56B55B4082F9E7D43227BEAA6FAD5C30EC818F826B9C37B63FAC81A46E9CF5BDE7B5F5CDE85E59B43A09A4844D523B2E6AA07DB34FA6C48679E7E78AA80C6A9AE0FFA9F05DA4681316C489935E80EA949553B8FC84BB6DD2A97EF7BACBCD164274CFE51E01104DD8FC1666141A6FCDBE816209CDC77A431E787AAD5E4FDD60ED66CF7C3C60D8278BDAA03FBE13387D4BF96FFE550A2FDDA82836BBDB3B59BB7897EF585A7CD09ADC31D1480337938B7CC98F9F0E3001DB13DB15AC1D1D0D1E94B5370E1214D6FAB79C45920057BBBB420C48EE69657B99933F22F12EEC94AA2591499EF97360C472AE714978EC2213739DE95BE2E0718D3104525BAB5E0A49DB7A5F445492A0AC4D699F4E1DD5A92141547C0C10E7982FBA1B33CA1FE9935A52F1C51B8C9426AF5A049377051BF17720FE117FBD2E3335F648AAEDCCF9C3D7A0195AEBC23494F219A32FFB2410655AB2E1E8C031417AB88319C12DBD403DCE15E90ED41D24DC7E0D8E6229456AD117CB55D1CB441FCB22D617F16FC1EEF977A966DB0B8653E831CD9C98A8550C8922708BAC69E18C7BD748CC9ACAAB9E97720367A9D9C83826DEAD7293DB9186B51BC673D02C5A7D5C1CDCC75089B8DF7241A6BA2D79B97CCDCA46519B9392F474B0605E5A0609F245B00F7DADBFEE4BA41CED4708C6EFEDE45973CA62F931FED6C7CFA81C210B06BADC9ABD941C0E58037E2E8D80536AF5C50E3BCE745349FDF65D44725144A6DBE14F7D4552AFB51A2D09B947E8D6C049EDC00864197A01B9DFCB8AE381B5A282FAC743699150856708CBBCB11B7A8CDF3E98227FB0E43B7C0A8238C9D4FA691FFDE9D35D1B3D4565DE5875FA6539CE0A73637F16C0A8B4FAE9693AAC83DCC81268F0615394E4A4C2216A6E66C9B0D0E5DBD695FEC30496954B6D09481E73963D3758B7D36A965B3A3A39B218CB762C34A58E099233E544852FA8F6793B81AEC3DF03317B17AD351F399F6128ABF58F2E7C2DC78509D858DBA8254AC98D12673B9D6A418245893D165DE62AFEC20E02266E59E90C97E2589D26EFE1FA8875F1CCB8A268E3018D2913C375384431B8539DD6746EB3804D303C780438693E4A165AFF20EE456AFBB7AB590744159DBFB66EC6D4D0D4525B5F54F09C621DA4317CE09E4F7F902E76E7438750FC1223EB79E6F70A5577FB7B8C7D864CA6FFC9CD0DAED5C1C602BDCA59CEF426344CF962C65F902DB392E2BE2F0891802ECE3013E646C5F9BFDAD9A7543035DDD7C1BFE566D5FF2E6F9D7BCD163B0DE0E5A72F86B87975B5722673E008037C9FE94FA6F5E4D634E66A4701FC926E80B955CD98215C6E04BE2BE63C77549E6EA584B4B7914EE70448B5B053A4387D5768F3917216673FB42CF1B39CCA77B135A025AF4F3DD1B87B310DB373515AC4C229B811F2077AAF00D462DE5A073B73B26B4736299E70EF0A4064964EAF0FC2B9886D490AF37ADC637ECB7D498B179BB58B81A22050118B5764F270B86E2CEC2F5616E03BAFAF4D2709A9D862B904AE105354D1D10F00F04B6D37D077F71BAA93520A3FA801DFFF9483B91CC8AC933148DB195939108F300BA99BE8D42FFCA6F717E1A428C33AB00B373E96C88B0E9641E2C4D33A957FAC37E9CC61E76C4ECC3AD69A39FB9C35196575639C0A198416E77E30FE85CB73A18206AE528A8A9706D897F1EC9DD83A85AAD4E43BF893B835EC4441818A12267C88BF87E0BA9022504F4417B3A2784D4B779F1071EFBD2A00A56171DAA7349"
let test1_sk_str = "4B622DE1350119C45A9F2E2EF3DC5DF50A759D138CDFBD64C81CC7CC2F513345137746E7455652AF6FB764833242F064FAAADD993B49FE63BCDFA2C55ED3ECD4A42AC64FE471930B1BDA8A13A6C04E044E68D345E012720A51C36E4F8ECE2894F68A14454095EBE742C72278C872D5B00707372501303621A575041A9A39695374640673712A6496617280252619337645600779238653143AA58091A243360A4929025A294528817006804898A5A094A24782A04AA1370929700811295291331949684183549140A052301A911601646A0283A3695484A8896426943541217A1261388417A7915190A51416A1A66971122159127001955193A58184622A8A7944087A52697738617513373088061547134A60521553531936735144390274765A8A99140A0201A6921A34A078259374295792181128512867AA19989A636106114803852747105325355783AA8A5A74909AA799741A12356A846522A029289608672A13077136445306071509A50A66906348A349702042356233914591376A4675749202987221A2262896617877257693307032A4661283409A811A605742199646038150457014154A21197910129008A49A339203090661233270A71430588A102600511096924580469A2A065758917774566292649602349059597357A476AAA701776423488286837A8224121274A849870A03990030389912173598426112034241154AA702666673394713A66A708758275923435A746A8A797330504A4935783508423146168587A067031457372A191188A05424973832A2033436986059865316118A577997690478448634A75916098068568217A7547141166636881A568183A297796048912818869688794596834A59788347432072863003468594673A858971482A880443137765A9A83271202651834110870692324832687394185053694A983674003509A16570081503842AA16188818670780500958681582106505A9A7381A7671769533782164873350305034980A1495A97102587024672630227625689553063139133083A7215807465138303389954214794851AA8060A63826206757842473796240A26434A6559A144809173783337898A60201851A7241184749A6A0026730A87172996745126479A675A0910A68364617770566191A6503323749016938759694902A447153414656A643A7A32AA60242A5461707741818A826957425A3A07470367605226A6A895939055392885333561476678949AA90728642084A24140A1A4117803A32706A00070670334821294329652852459222188A0587618A00095A9612372781375226439647692A5908A88002943A3710042A2A51702495545A7931800346572951AAA9658687643576541694308538974A464686A7A934351289692612A150123A608A90215742612630339332A59A9611A167265A166412534787496AA14557A35979764573381153735A6665314203607049891A5848625847919A637A5879897406A444142206673236509A4A813514446763A29988344454287016460A17814921417416A0396651A952A301199639490055494179A3438553A893355437155260045464821709000A47271639A84A90A657AA4673923326820929A6307A72600089028A5A30745186642321A3473209618238AA8979726206935218579892734713487547764813727578404528491555379973228844598444364665161111892741565A3656A15383A743929828312A199549818535924673CEC46AF0D1D18889A9761ED94DE972C9C9F743AEF57BA9662B3CECB1A726E45A11E808E81F372F8ED3A6F17BF588A154ED8632EC1261396CAF313524CD9265546DF20FEC65C17911C32DE558D0523364FBC6D61089F938527B9B22F34603E4D517095B21A376E0A57EF94E65CE80291533B761479206EC9668015919320510F279D4C46FA69AD152837237B18DA8FC7EB0628AF8C3017B895CBF271B392A7043AE30B654C13A410D14451FE3524D42342377B161CF5838B3E2AD2F4FA455FD9824DCF4D017F2EC6D26CA07F536A44C47D8D4802463A10C5BD795E7C3657E97B1E8691A084873F077C25A26C86F01FC265AAC75E2EB25FB506AFF2C2713774D31F83CC6720016F743A957D9F4D3148F62456273C1EAA4A1679E34650D42087332C40298A48BC9C21F2A8F096B9C675ECEC2B13656E5A1C04E02BBEDDBF37B8E53DFD66C2BE794905ED62A59E93E142E7EAEBC7383C16D2EA5D78C0C4F140C5E713A05756D39DFB7920175A67902A6CD9E174F48A6F04D50288152AD23B70504433A9FAB7D8E9570279D087802E8860C8DE4225068C24263F02C2E851F3E1D68273DF36CBEC649B82542E5D8A278E46521FDB0F578F95FE7922B21944C92AE7316CCD2DC3308EE71B801D78E7EE016406947E007938BA3E3DC9E44B200FF911CE50662C6A3986FC0E48530A7A20A2083C3403F38C70149F9D9C2CDEF173F14827B09468FDB311D620FE94256EFCC45D78716FAB64DFFF8F2840B7BE1474B751F3068DA4D203D5065A56B888B07F7E791D41897278A69A2728713C4414CAE274139DBE36095A28B1EAC922D686AB83BA6DEDA927C4BBE5D03A63A2F925E72D8F03BF483EE3109F7E9E79BF0AB00880B87335E0D4E51587DF6DD1EEA6B80DDCFAE1370710352F4A5278B0E01DFCB6D6F9C0C8197545084980C08410975B4C44A9DB8D6CBF9D66AD2A0230BC2427CFF37D92D188F7E9AB6C1CEFAB05016363A31844EA87F9F2FC75628179ADDF818E3F4BD25FABCE6546A2C0F436F8ECB3AAE5D652339519C6B4DB9F53ACBDB6BBDBCAF26D81C4DA25F43EC951745C85C5D1FDCFC7D2FD2A355BC1C0877AF61AA13B50DCBF72EA9B0339E7724D76EB56AFC290762A94E2BCF353C84B9E013E0E03C4F94B622937CA86617129876DDA3CEA2852B4A999B8E8898BF6A616C766D16B142E45BD8C37030C1F8BC64A2C6D183C6465C42519D6786B5D70D2804416A629A971AD7454BDC0572F9D0E6775C3A11BE45CFC46ACA6073C68273E898E0393F31ADD7FD96A72A2B89CC834B130A7319B07CCCCBA1C055D8BDE7DC432BBBE988A304BABA161C65ADB24C8C7A293D23B3EA495C869F9276CFAD7588623F2990022AA06684024274571AAEB53FAF6EBCE7AD120AC6A97613455B660BD8FC6D7551719B788EFBBAB7A4FC0921DBA408B2F35FB05D4FCE6B5AB102B94AF9E22C1D0A51D2FCD240D894785881DB742772710D95DAE5C08700E161A8A589CEB4F4FCBA27B163CD592F1C781D4DB82F466DA1EF21B8EAFF113C6820F860869BA2E83CBCBB2B118EF768963D900C7BE3AE782E2D728643E57E8A75B4299F941F1AC5108097799468F7A8C725E7185D34439FC57588E20DF1180DF801CA88CF75B872285D3FE785B95CA554B00BCDBD67F4E53B4FE282798648FFEED94047A0FFF0B6370A39B9692111C3EF303C3480FCFC6A7280B054939EA1A95F3042F2560E63BFBBC50864860836A40CDFCD87ABD37DE67696CABAB4203BFE9EC638DCA838B39A2A4E0A5E0126749EC4673D3CE3986F13B6124E02ABCB42DE5392C2C95E54FE2D6E0EF60149983953F165FA492508DA1C6C98E888577FCC2F3BC484B6F13ECA1926FA585E100B768134A314548E9F98D037C4B60EEFE644EAF233600623E902F2753391F06CF9ED8C97A03D3965FA4B1BB95D1120CC144E47407AEE5B4CEC29F6BD43C90B996A7D49035311B74FB162CD253F3C7DE6A890E91CA064CD4A34F57C2914191BD7354EB365D8848501FC0C3764C817F1C56FA6E6456E4A25015DC284BF9D3A3005558F3393D36504F3E0E18BF83313794E6ACFDBD2BDC69165FACA6703446BB48618756800F3FE73CED2B2A7A593584A3DB18A37357B9D4C43CFCC1D0B04932C5818FA25965C5126B795C5FB2FE4A0BAF9848CBB0EEA6BCE432950C8AA2E7817FAAAEAFBDACAABA3F3313814419B8FD07640AAB8EBE02EBE619EBE9E5CD8537558A2DA421F421FD9FDF9E14978A9D31414460BE1E27E4AAE119138D085654A5B4D909D3A2936889DD14475ECAC313F1A90F63445DC20BD375C6C65ED17695AED1C792D70013F1FEE9208661D08C0F90B864916128C338DFA1C4BD31C72DAE60ABB6A8F69B456179FAA284122A9C6437DDEC3E746980044DCDD05AC61FFA636DA9EBA4CDDFD53DDED53A617855B850143B6810AC276AF16B036C57C16F34FE62005770AF1481BA9CF20A6EE38EB6E9B3CF1241E1CAB856EF22F29DFC29E01E1A2D072C622D95F97EF83F52B51ABDAFC82D79B318ED42591F38F59FAF37D293EE374ABD22E965F271FB7FBBD02392D55E1F24CB51C3E3277BF558F1F38362694745AEA89D7CD15D1861001610AA41EB998589A06C9621A5A9F723609BD7AD136517EF4A463ED95559850B8AA2012A05F67C1FAB4E945C50FA5FBFCEE0BD049CDF281E02DDCC3AB058A62702483DD94B17EE3FB6035C7EC6625DE6CE541C6F754634D5D366762A8612C209077EA3DB0215F1B729D8F64EF066CC121C295A9255281574E12EACE947FF4C066E8CA0994D30AC30EC7A4319794CA1E3AEDE05CF1F3578A0CD05649A674B716978258FC88FEAD4A193091060B50FB3718A2DF8EAD2073B1B02D881CC90CE2E1B0E842EBD203AD44A4E621169654096CFC2C021D32E85D826F3D5BFC668EA423B963A2A6A9974CC28EE7E2CD0977E8E6287F04D94FAA75F27B7B1DB6DC7097C526CB2F3DB60E6095CEFB103CEC0A6E9A0F186CB457E7A48F172485C5D293C7C973F0F6A277784A8BA034FFC82676D7BF60544554238AD3189919CBDB4682AC8A2E03EF5735C45472CD0D5ED83252EA64D30EDC72A269F3F22A9D5ADC872187BA4D6FA8969C7F582C83B4AB71163D841820395EB8C5F4797CD420DD6CF7F825DF4DB3A8B029D8A"
let test1_smlen = 2767
let test1_sm_str = "603E68AC50CEF74A3B3AA0EF2A5E44A8E8F9A376CF7C38EDE21EAD33E9394C18F19A39D663AA7C197D16AC7CBA97260B7852C2CB7D357773860582DA9E5629FA710A4534B269F9187EAA242D2E3F1746FA54B6724B5908DA75253FDAF670E4CD283050E6BDE8739BFEA17483D90FDC0EB15DD3A24C9A0E23210870F21ACE2A7FF1AB1FBD7DDB15A5540A54A5A48324EAF716070A5EA7DF5DB4E9873290BDFCAF492127551E1C140078E839DDE851E8DEE7CB50E4B1331FB0A831225CD5625A65EEA6D9E1CE946761C0AB5615D0D7C3354E0763F5EE3D518CBB9FEB7D13066CC0B3ED1F38023AA989AC10CCB106F94BF6D6DAFB31D5BE24980DD9750DCD0BFA9F817A347ABB8428CC7AC5A30B3856DFB26D37636F26E341BB0104778A2B1C97C06135B9304934DA04FA45DD7F9A359575EB018BB9766CAB660D4718F4BDC0BF95111FE88CB298CF2CA60C65EA4C7D0471E9C299B2C85ABC490752C146ECCEF6D1797C2FAF87D0EB55E82BA811240117B29401385314DCB16A7D4A6F9FC37EBE9C1BFF6B3BF27C17F78DAD79C87F63F66AD3C2A8BE7E4A75AA9B20AB1C0F55C8BE374750AD766BB262D2F7A55F4BC3663CC06DA07C567D7F208EFB0585CE81E3CA10B99AD9BEAA09AE1FFEA813E7619F5A6BE040C625382E94EE5B1EBCFF69DB6BC644933B1D777310DC2897BBD62F0CC46BBFD223F7625ECB09DC53FF357CC38E28FDCD3F5240431122BED56567DCCCB338A9E6A8090EABFAE12FAA45D8247E3D89919E7C6E70108D21C60512DB1A6C596A531A66A5A60BB7A4E447C3BA5ED86375D50F9178606AFC5B9E4ADF70AFB6D98C9D79B17631BEE5A5BFD4B53E9F9EE59E06CFD3176F1DC4BC764AD6462A49A1D6EEF811D5E63CD18AF8BE94CD1D48D12928FBDCA2AA719D655F237DE6E203C3C56E7BBE0403F2D612667683623557CE95BE529CAC17F44766709C58A5C0FAB27CEFCC1B78230F8EF3890B0A1927F4A395C7BC6459E2AAB60E606F9283DAED2209F52314FB6B4656175BD23FB22C667E9F5832CD1A7C6302DA3F12D3A0EBEABDBA7140C3BC838B06DDCAF75278CF6B1A38ADB6BD33B17B9644DABEA40E775C7D2D094E8C0A50794D91F462D6CE4F3FF5D5E0FFD8D190F20FB34DC66FD9703091C00C96149D3C372F3F14C14DD7E75333F4C6E50045EAA2957403210C05654E9520BD52BB455A8E10284784AD5E23635FE4FBAA3D710C39F197FD3C8AB45312734CA899BA0E8A9C05503E283820C7BB8DBA00EE6D9A487E66FED4000779538F21411669643C839A547DB427847A5B61BE7478B967661522015289BE48BDAEDCA6D702AA03470D53A1DAF4FA81D389ECBCB65A7E4ED78F954CCEED0A880328AD1F04BC7415A6BEC9E63B61C19CB574D4D76BBEEA025B9AB555424F4F8F961617FB89B9E51DB0A78CD9081AE814A12254CDEB8B148840B29514A4153790E6D34340BA7FCD77B75391165E7F323F91D563C8AE59C4C3CAC7659A4E0082D6DD73AC5FD797799D2A5659A00CA6C098B5F1D545D86713AA04A87EEDB91875CB69666D3ACD60604BA56EFDBBFE3C12D8B661B2B3AC31591C6B565859462CAD506B0B2E84E06C750D2BAEAA185E38DBB1D1AD6B18B5C401FF2562458FA0506DACFC51BB2C6F46CBEDD233DB24F420313B6AC479F281A477DA675384FF02393CB48DCFDFA5B2CCC270693EBE9D174DDB55FEEADD4635345D187EBDDB2A9EAEC741208F5A30D9E6177E84DEF63ACBC9D1B12ABBEA008202854994BEEE1F87D42764B8D865E328994E72238B4DAD1780FA62ABC3D1ECEDA61C57B3CA7AC5388751156C2AE3A9DF9C488E271DC9E320AE1C2694658EDCBEB5A0068595287A277A48648F922DE7B7A784AD8B4DBDA6E107289FB1E254603FFDFD8A87D64291F4E543AC040F5D1DAB082A50C2069C3850B2886043FA55A5063BBA26FD4AC1CE381BFF40FE29C2A27632D49350D0BDFA4295C375F6ABF67425BFFA6B216790D9BB62AE702E03488F21B8E70E45D30CC94088DA4802A900DD050A2E608566A5B950540E604C166275532F459A77E98F23BB26A40C63CC073298E7AA23A4DD44378B9574A3C6E563107DD933E0BE05FE34AEE4EFD27DF3095A62AA04CC2BB495740D9671E44E16F22C0A882AFDB0A9E7831CEF0D43A79D0394B7C0C9D448B684F7FE85DE7214F7A255E694A2492DFB6CC59FBBC4D5B871159395FCADEF525D64F8E176A79FB2BEB2989BEC4F6EA6B7D645D66E3FB05E0B29EECBD9404EF56ED14BE749B8C11FA51F87374A818EF5CBA5CD7F0F50877515D91E3FFA52762DFAF139355A4DAF81A0D93F87BF1B0E747615A9F29823B43ED5E6D1C82EABB7EBA2A99FBD498772487E6F6BB6C02BBB9C0218987A470CC2640AD21D729A16EED8CCD1ED3FC78D4BE30E38C2CB3BE5FBD24D257C00C4A31F8F5D8555974F4BD2580C829689FDD8A9A8AEFCF3FC358571F3AF52591C815301E9DC47F6BA9431128914E455E019869629C560F2D3A3A2F89930F86A721061CDF8396F7AC9471F1097172D34DD80E91DB0993FBB6334BC5CA2DCF01A2F76212F1EEECACE4FD11650843F3113136015413C685859F61A883ED2F23255D2B725196BD57823E7AFAF5F35D7F5AFC8B75DFE01E97FDAA4CC9585CEB14EDF142550C68920ECDA6C020A8F9BE1FE6BE5B1811A92DFC6F82CA58BC19B79067F81F5BE2C8F577FEF862769DE7521C8402CA45A2EE59FE23083ACE004FD7FE022F7E9F519E1BD67E8738A7972F49EDA68A0E9E6C216B2AA6E7F5281E0CC9FF427D2191DA78220BB90DB55FF7763D82B1F10583FCCD3F5DD0B48B3F1B1496D76FDD66AF0AEC465F57A7FDC7CD74D97C7FF4425CBB95038833DCFAFD8904A2BB9B6AB0038248681624B27031F7101942EC38ECE5D13DC5BC677A0173F6A19FF777B9A295557CB3A4B38C0C9852D78E9297BC04293E1EE0F27C33D0D7A5343C8A208D6CBD7E21D50A812D31B0D823C7DC09DFBD2FD6323E1140D4D5F9FF853A52E52A9FD7D46A9DCF6FDA4E59DE0F6D2C1DB94546A2812C8DA32321853C148830915E2EFD5C3846C4C698C93E97B175F76A7710A85AC4DE21C734104BDEFAE3A04E432A161E727B8AAEFBEC9620F0E138F12E749FE9BADE742355A92B89F6E6B468E3471DD3D217D61068293C7354A17F282195827EBDA3EE2CB401520FB90DF511ED20D8F8C69F92318C3F278FFE815A5117E92C571181B61F67D72088D2F89E096A0CAED00A1F7D41AB3C15D5EB6E094028D2674AF6A3C0289CC29818A3F677CE71B6DD173695D5D2ED0DAC57C7E8A18CB92696657FE0B29C0A92092C1BDE7AA00D281F8D324BE33102221C3E5588A2772A27C751E974381F208F7B6FE23DC4C0BF45A121440CD9B2336B41B00E396439346116247EDD19F228D9F6A243D8C7B56FF37C5D072991F04D5D198AD17D70DD1919A66C4F8EB54259E96F1A58CFE644AA0E39C9C0F2F370452C20B1D3F37669FB8F65AC8E9CBCA5B0A8E68A67A0D6E54A42FD44CDEB4B811E2613BFCF97DA98457CC74AB779528A8DBED07044759DF33892C2BE88F5D93D7E821745E03F4428FC1D132A6F3FC5959B4F4F188807D7A5FC6606E6DCC08148C080D20354B696A70737A819AACB7CCD9E9F5F6FE031D3C5258636D92A2A5F03D4850595E7992A3A7BAFA224C52616768738A9FA2C1D1EBF9FA03081E2325333646496D6F70839DB1BAC6D9FB0000000000000000000000000000000000000000141F2A394C034081988E861040202840000640282808C00C30064498A0880410ADB4A10000F29A6AEC2CF2EC0F225D5CE2CEAC61930A07503FB59F7C2F936A3E075481DA3CA299A80F8C5DF9223A073E7B90E02EBF98CA2227EBA38C1AB2568209E46DBA961869C6F83983B17DCD49"

let test1_message: lbytes test1_mlen = assert_norm (S.length test1_msg_str = 2 * test1_mlen); lbytes_of_str test1_msg_str
let test1_sk = assert_norm (S.length test1_sk_str = 2 * skbytes); lbytes_of_str test1_sk_str
let test1_pk = assert_norm (S.length test1_pk_str = 2 * pkbytes); lbytes_of_str test1_pk_str
let test1_sm = assert_norm (S.length test1_sm_str = 2 * test1_smlen); lbytes_of_str test1_sm_str

let test2_mlen = 99
let test2_msg_str = "2B8C4B0F29363EAEE469A7E33524538AA066AE98980EAA19D1F10593203DA2143B9E9E1973F7FF0E6C6AAA3C0B900E50D003412EFE96DEECE3046D8C46BC7709228789775ABDF56AED6416C90033780CB7A4984815DA1B14660DCF34AA34BF82CEBBCF"
let test2_pk_str = "1D836E889E46259BCD1CCD2B369583C5B47CFBB919EC2B72C280247CB15A55695B8D3CF3B88BE90FC0AD078FCC72414635BFB82752639B042F9E950165DC7EA88B5F58BBA0F22AF7F682A623921148E0C0F1554BE9168483029E01DBC29A63ADD07A0623C113AC86BEA9DEDB315CE987A1B6C45E613843F093361D3290C5010AAB43C6B310B8C56710AB29ED1BE25AAA0D4191C8BA9E8AA0169FF8527B5EF813EBA7781B982743D361671A72B6046083420F02F1D90C226FECC3102456297E504EB68B79097761C42570684C14DB2086D42CA5EB878DF241CA0AD616D567BCE530BCD54944885E2F0017DDB41362E6689CE5C15DC66653840B5E2E384E796EAF7C163B8FFC7623E63AA310EDB605EA8E07D68008B62BEDF4F18CDEE4B5E1543FF583AB27303E5F000FEB637091F4562BAA53C579C73B04F8052856A29DAD82321896D05C97DCA21A6029A621958B150FFBFDC9907E9112249C1463F120A0F49215D9BA6B1623FCE5EFF47353276B7C688ACF8D8EB52070F78DAFCA0E81BCACE3F9A27E7F8B249C2806F811B952A98B47FB7BF7B9839169869489B5F6300658DEE135318DD428777F32C0E75999813220D18550FB154D2C8F6B3BA5F44BA9AA3F7F2116EE719BE23E2956EFF18F48EC516FD8FF305F3C531D46B3806283DC71DF242C3DEBC18EFD6A9ADDAFEAC74B249F036C40B1545DEA0AF878CC36CF6ABA47C5866748903F3EFC6BFD03967C376A7000818783279B20E284001C1FBCDF8B7E4ADECD3D5C01ABD3E3A4E91CA20C562ADA9B66AD6DDF118831E46922F079407EF2404CEF5F5BDFDA21AFA5974ADD1C5149AD3042CA6F143A6CCCAEC7263B22A799FE964CFC2661121A068B028ED1F6F861DB47DEDBD6C3E2C10C57DE332EA90349C3A2B2DBDF1825F7F7FDE62196615642AEEC99CF9098C64DCC237CB56EE24BF9B3D0FAB12B859A05B45BD9AA7E56EF1BE93C0E87B72803BCA4A2C503425E43CFE6321F6A5C4BB12091ADFDEF0038E9F533C8C2BA042D0E73BBE380BB47BE0CA535BF85BF52AB94D82CAD47BF10AF00B1CB52C5AA9102DD673E3DF15046AAD14D2B7FD2D6055438FB65CADE622A38A189373E4D186E4D0A562C94CBAC26B6FF4899B79CAD9FE298A8B4D0F830DCD672813C04F71B6F4144ED5F5F4FFDB395DD88BE9727ECA195DFAE272DAD6E741984DCB38040744A9DD8FFCFE8F615F83DB74C1601EF75A09056452A525F175A5D15D8186AE5557B24C6EE5F0CBA5F117EED125351447B647712B6FE9241CD308207C14DB6557DF0C480D91F3A265613F0C879AE6E56045684031D8A7404E42236ECF14CBB5894748F6963D6D997E4C4B5AFE677F42D6E55B6158DBE1719C4C84E7433CFD5D54838454C6C54FCA9B2F665F04BB58C50F3E2FDFA98DF0F0FDA8D75FEB332AF7C29E29F1603DA665D757E5A1D7FDBC9BC5E00EF4D5B3EB281C12CDAB52B34350F220B9C0832155DD2A5181F6C4DEB4C19BFE431E6672539EF1623DBBA96276976C98BAF19469F1D7A870CAD446A14B195F636FD41F9E08C9104ED1C3289BDD893F58B3A847DC867DD14C83E2DCCBC3544DE73ABB55CFC4BE3BE490424B0B8BA2099FB2BBDC02D1F78C4089C5AF43DAA5936BEB801E613BB9A97AD71497F8D3AF51A0327861EB0DF11DF50A2B2AA2F8EEA96E767AD78D3E168D90BE074CB882383FB05426BD14408C0FE44A14F92893C734B264F5A40D3C7DFA2968BE1FF6C00968809BCDE6607B70B62A2F287CEB6F36FE2E25A0750F6375FD5B642E8C2C46EB7426A808251244A8F3E49E0D5B82F6402AA349D8A7854344792355FDAF2F50884CF0EDA7235B83672D617E886DF002CE43A79993887C2B4B9DFC135DB2D4D547AFDDDECF80B485F4AD0877AB0A47C8629CB7473DE291AED1E3C79D9742DDE8B4BEBF471CF6BC2DCFEBE1BDE45137E318B8622B97B7735C9A3E7559202A53EB27AF214EEC0689E3E777F6E25F5EBBD0613F7A3C51B9B92E0987C1FB865EA4781DC2940E23350737286977545B5C22FB45AE21A7DE575DB06A4C364D499D57DBD91CADDA71B4AD3EED151BF8B21"
let test2_sk_str = "1D836E889E46259BCD1CCD2B369583C5B47CFBB919EC2B72C280247CB15A55699499CAAA80E4AAF3A2BAAF82395BD72A821C3561F8B7EBB881A2DEDA55F40D595F8D9F3248EBA88DAE9905784DF79D3789C4D340C649BCBB7E9D5C5AA3F8F055BFCFAFA4698036233A70DF8F08166CF022882686296A694AA748A86707057254A3243736643A663104927295491932160A9347212A2A38677A923A820752A22A34734177780812520A26A953A6909A534454106998490581757927A886509372A7054A945A88500A440057198726310946087A14036A239681A49611869832844476A5898179A0805176485863189AA7A0936626221347A9212A624A864167331A911A466A9161A440A014258714A51314A33A7597A9747996084230808A687A02758A4844808025112628649254422283311237A74112471687369637724A26338945471313A203914394A07A20347651546534722468770656805280A4A325368258271A1399136AA80976A460900794A774A032763259219A4184A6991227532778182A733A43329A188707298498077575138210553233370395692497099747405A60521031694A0687A352785485895A155103609463A45834128A5884AA2A91A15938262A5A39559A89348A56065007095844A7196A446306749668756539588942A1872586A83799701A2519888970070AA5734731519657208038A035808240675574966095326A57050253645580900166249A077103484185333666064257778599028A8690A88029351037748A9114819258945630678484310151A3741849065A528951998569141235417697383AA81A29502927003218687214156807A4414A8A9A037294981A806637786529705324A51887867934311AA9A5116894537675520108807A224885974089896867986A8AA01A583899790A35716192668404785A822976461268183628680A27A645932333173A3351A504725297A47539046917345271423654A008942A8651301659041AA2A52073949112914730A30426418A59536162A92625787391403121307439002054A5A2AA98532531390348059005168A70554579668452209AA13A354341A2078A5406AA18A18343115777412809993A5889491AA2A63048170978591763122411785320170885147689A60743923312131433A6589531860089091641114A498681AA15896005552662910674A5A57735A3591214141719A10193358893400331234618AA18803A6461890441164632731197648879A26281424785736A210873695418A2572079A516A4614613733540167A5481A72592586722290446A53263A960675745161524A587001534052A731684910A0075364336694261236550A10495A401660A8068928493533332A04A520651558902280099140769007982106A990A05401A8093248005597657288354003014A34876426858656A85A46634A04541A87416A730472874A252909699048537A5601638307A77A67277979118723862A754229A52A263884175954042295620064719798622655251A204083964770581324A37514118033726998097213570586054636453897811107918940508933191A63316490564244264670AA89880269A29A2818701AA005A124194867458731A1064764566A49132244AA41546710503154004124384A7935A2960AAA06A9687A7753A732A85A625A2687586A3344629814912453657720358760898122148A60A3283630679463A46923A6087084211387B4F10B8C28FB5A380B71F49495AE65087A690D74D8FB96FC2FB62146F1F6DE93E13D5D31DC4806EE58E261B6818A91A29180B42375E282B4571630C37032B0DFEC622B9EEF9919AC0DD6F5F6413F18E15B7BA75E1F39488A079AE6A1ECD6D248C3F6E4B0DD75E6508687BCD27605F466024B97631F49D11605EDAD1AB29600E9FA405AB1CD1A790D4236286C68B418E3835158360A470185B302630BAE7CEF3FAA00B4FFEEF9C433EC8882D9C019FBE27355DC5A3061F568397C8A7F31200125D28B593C02A63942EAB70C415E743C43B2B1D9E8AA74BE690DBD167041EDF887C6D45BE6E8B93EC1586C62C3D159678F17F211D01F827F16AC2A3C1932EEE8E0CCA1106EA0334DE161DC2C7750161AE1791D7CA6AA8208700A15416E5D8972D05AF2B55E9FAFE8ABBB96F58EAEC307DF2BF17C858B213E70332FEEF6B78B4AA373CD81E6C8EABD51D71C665029C48AED4831155ED80A63267FCBD045BAE225D08CDCD9CA285BD1275F2A56CC68B16B1B17895C57570F0F1D04B4B66091C5FEB9D451194C4014E9AD67604BF13BE7E4BA3D84135053A16F698D6447BB63B3FC5EA95BA8CC02A58531D659E2A1428CB2EB4D2A53AFFF57C32EC401E91C88B80F78C05BD933421ADBE26C102521B1E2FDCB550201618BF6924A700119A1706ED50167C0F28AA9571399573E4DAF48E738BA1E6E7A7DB16149794D8E215924BEAA96FDBA9AD8FBF09A17F9D2487BA2879985DFA35D3B9E507D78FEC6FE761DB3A33217BE61A2EA16593291AE2664FA95965EF12E5124318A10F0FF2AAC285F11F540BDDA8B4A76580E2B190289873D0275FC59D518F7DB463F19F15411AF58B44BB561F8B210D4114287B481069BE09224B2CB4D0122EC6A461699F732691CBE30B4E7E46F9520FCF14C6072495F42DC85C101334A4EF3A37BD663E699AE22DB3371FAD51F69C71CBB8FB1BDB8CF7A93E1BF41C8EC86253DFCC70389548AEEA075A272D7B672A25B93104EC872B7741B50A5D877E8E31CFC6DC778E9E049802BDA2EB49B1C9517E1A1FBF4969D66E9C42545D4ED4B4871E7930359533E7715D4884BCE040A3A60894FDE444D29FBD0A5926446DA371C1D14A68B1FE7014497B349925A1AAB17CAA7249C7094BE25BF9A8CFF35470FFA0E171ECCD90B0C0CCE1BCD6B0595F723CF96FB1CF9775E11CBE36BDDD5B8052F6F3AE8B6485FECF3D2678155F90BEC498ECF4CBE751B58B5F84DE7F48E734B4DED590027E52E6B1E234145F0CF7D7565180ECDCF7FBAF309209CB45F45C904B30CCDBCFDA7916D863D01ED0935CB5642A749F2FE6D375D1F8D626A7D090B04B000B779310ABF8D0A0D3AA195749B6749D2395C6BA8D95305A99EAF2E43CA9D03C26D2FECAE5944AB7005842A8021B0E25E60D4754A74BA7BE980ED193A6DCB6C8354CFE8CAE68BEF6396FB0A197DE18A371B052A273E5802884285E0EFF06091B87689D4B8ADB21E46A354583EC8ECB39B34AC921D152D3944DACF7753F4A332C3191293AE8A59323FF52E8A1B04EFD306AFE7F8477FAEB42629A0C33C082D5D8428F74A7AF99EA4FDB424935FE3E8C0AE0868D2B67A18BB14FEE061D0AD79F7C335A8FB51ED8F3A0EAD1CDDCF062D1A6113C406748088D54088231B2EF8914CD4BC9DA9857A4937FB294FFC9FF204E1F539884371E7729B9DCD985ADDC5763A4E8EA4A282DE4CF85760EBD36FF2336E5DBC5BEF573C2B64FBEC8F02BE4B0E31681B2F3C973C235F39A71F77C4743F1D23EEB8CABA87C7367A8ED4D9B77E3520A2A029ADAAE640A662ED2ABD0987DF5F7EA2C2C8F561810C62EFBE20159548375FB601EBE30FC657E8A651D3D288B2A2F47EAD09D9FB6FF83D1F6F12DE97BBE707FC8D641DA3AE1ADD99531ECE25D1F0A879D71D74920E03D4D0CEDF1CD7F8F80A8E1D089A989470C8CEEEE3DA4DB5E23FC23FFA1BA935F837534697107BBFD5905968CE1F48DDEFF53D4F4F8F2D685640E5B9443DFD57E4DA28FACA33E1995E991348AF49CEB15164D77EB8264D2F6425410292C36BECB874A14F3BF97044C02B9BABD8F5E0D3A51D5370A81BB176C3BB527717DADA4D6E6517DA12FAAEA737EAF0A7D6D21BDFCD18126452D6CA4E5059E9CF50D408BFF56DE8668B3E3B9EF025BA4B1F9C5FFADE458695E904C2CE09293B134EEC4B360AABD198DEF9DB0D1C0E62C0325871CA52204402718B3601BE6997D6B6D43C69876227BEB58EBBC1B8EE36E142C63EC34E4966AC0420C4C98824DB931C376938FF20E29C4EAE73A40F05F5BEC3CFD756386F8A9A41733A0AB25FF4B11FB8A9DD2EE417B4F77D33CD39C773DC0CD4699B60D62DA07F9E3589EA6148F51FC1A2E81D4F482279CB30F4007624FD7CA62AA603AE62638B1D520D86624D1AB5E8D79AC5D73A310F0778F4FDBABF74A23AAE15877659B1552057040EC3B61861C240B7CD7F8D3F862ECA8BE16130A79733690FC60CA0BE466C32DC5ABC35574AC656E5E3A341AA2DA836D81043E0EF09DCEF5F776CE76B3E4E99E1FC1E7FE7DFEC5CB202CD1D1C28621414E75C548C99063CC3D07A4C6BA14C46775BB4C55A7F19B615519AE78E1EAB31FA24F07EB53E427FAA4F8452EBF6428CA5D2FE21816A784CFB84A6A030661300DABA5BE1BB0C1D41EEC87A0EAC0944114FDFA859BC2E8D11E5D2A35C022272D9D661E46590717AAD7B68F533FE18D2B62705C13EB8BE8DB3975EE08CC0D0BC3D406C54AA20DF273BCAA96A00C92C10E2F228B77BF1EC6BB88C59FA6041C27E6ADEC440F727261B0495C1E7328FAACDF1773247FC2F66A64AC397B388F11070348711133E515C826B1AC3E9DB4A6FE294F59E518F1E41F41068EF4288E4435E56F678F4EAAE097BFAF8F29195197CB18C5E630251B82193ABBA77CBFE21A6461776725EB6073F838712EEACF8F68206DC13C725E120FA78255B41A8E658FDD1A436E7A79B5C466C6471667091882B6451D6108A7A7912EE2109C5AFD6CA660993FA774B2A198EA998AF0E0C281FB46F386CF30D57D1CA426BF47AB1FBA8BA4CE91A7C253F037C5809A2FF1DB23131FF049F6A79D8CBD66A87DDDE0EAF57971EB27BB926FA4277259E189813945A9874FD641F1DD628DAC1D9E77A738FFDBD3D6863C3FCD1D8F37AA694432802A"
let test2_smlen = 2800
let test2_sm_str = "8B23B9DB901844755B5BB6B89DA9CC386F6A9EAE36E5E49251884FC1EDCFCB69F06D02AAA5AC4CFECAEEFD0371C280B93ED365A6C3866DE55DC9625385C9B4C400A4618F51CE7D37DB88C361A532091E80C85B28854A806CF824BB81F391A88BE096B6648BE5143A5D620376E4DE9ABD16B7584F686743E4FAC24F5A3D6C3C3AF1E0CFF8C724582BB714A234716E156BBD318B3875CB8B4BA53661B007F5ED2BD0A968E74E83B9026C9680874889F003E63517582D51D3C2F1E90C8EF89BB7FD68612A7AC9F9F0C04C1623BDAE8DCCD487DAC46F8BD048C609221580686FEA689914113524B8196ABC049394A45903FFBAED0F941D6146B8442974BF707921AE2FCCFAF9E276CE834B1CCDED8D45B56ECDF813186432C5A68197FB70D503C0C87BFA9E8296E3BBE19F0FEC50392C92ED40A8851582AEDA9E10A2A293FD5B8E1F07AD2096407FC86328776D72F70C2B2F8CA0352D5AC90F4F3BB4D6D866B3F0C69A8CDA394EDEE9F19D5B5E853C3CE7DF25616BC9520483AD35435545BBFCBACE5BC0851DB4A16DD2B980E6CBD8F8E586F8F9E295AA2DE544150275059A0855C9BCEA15E316F7722C08E81797B30DB31AA29F7FF955CB4BCE7DE9F3FC5F88D06348A861826BA5812E39DE25A039224647B753AC9E61491C42711E06D4822D4A39071B911FD4FD3D060DC87FFD4C8D0810DAEF8ED044AD57B8E7D4F70CA6A7432E78BE0E87B254EBFBCBA817A496B57A6647B32161CADCF02EB4CD34BEDDBC5AC89D73969CDD938833D2546CA4D3001069BE87DA357BFD18DAC83FBDCE19F7E01B991FAD4D7BC04D5A5DD03EE8AA68E389803404000524EF1B5B228D0DF93CDE832B3AA1F6108949420C896CFDDF79848F759AC0097F6E13C5A9B57D924F7817AADC87ADBB1EB73309AAFF775234EB001F26B98D6041488AFD6EC3E61DDC0945CE10FF7B878107C61FC5BC359F8C1AEEF7C20334218DF32ABB51C39546FAAC733CED28E41D6468242E186C8F7F9C1A80A7DEDE9490790DF2EC1752A8A212C8C3AF45A9F075D5731D41269E562C9C3243B0F5CFE3BA77BF71AED5EEFB141BCE93964EF73052F20E06F23C73F6D5A0CDD6E29B2B47E79B11E71B31CC060507472D9A87009418A992D20303BBE66DEC4F05391260B86673B4A012250DA65511F7B27B289DE368C264FF4B5533E1B9D679693DACCF31F2424D2AA8854F377987196FE1D212EA298D149CF5543DB8624F1EF4455FA57A00283BCFC2A3778B0974A41CD870138EAD10CA9DC12E994FBD24988817F75D237B3EA1A5BE3AB8D8AFD3878348AC02B566F6B8610C504991E9FF47E4FAD7445B69E1E606C939F10CD09E0E2A7CDD510D2EC3DA8870F0FAA9FE5D5CB6EA3BD5E162C3503991DA8A413C0AB10B06E8EB8CC32A76743D18ED13AFF81044BA58F9B6D5CF610AB28E1F08BB463E224900402EEBBD2CA483DFB2FEAB53F9AC06B6DB25D71F3C2874B692769ABBE1FC1C10D705077F0DA1D6485C5CDCC266CA1AE677178D7139C3205CAD0A9E6A05D979012F7D9888117DAAD010B61ECEC8AE71ABBCD483F0302F2CA886AAA3D285F80D6CDDA0139B4A29C5F367BA24F80E4E0E930A2F9A13C46B3CA8F8151BD07C3376224DF08D58805F18EEA63391CC494D4BE33D098357A8C29FAF30EA8DA67E2A6A29F7C28128AF27A001B302D9A34349037D969E9EEFA526E59B4675585F67FAAC3FD768472909123887645C3A34371535B03A4B1C3787C25EBCD695F528923D0A03C7D63147454F3168D8AA3274B74F21FFA96FC892135388F1398FFB86988B01243C6E9174DD205235CD5C7A2ED200315F81B13F1BDAFC2B757E8F45A21ED16BDC9C205CEDDAB695C76EDBE9328A716A5450AD2E95BF7BE984A1FDB5851F1E3DFBD7D0FC6279499C95870D0962C650F2C06915CE9FC77A3E002053CC773A99B2AA23D0041FFDAE5D6A4A9ED226614FD4918D83BF89DE076CC40A4E4AB4BFE92A8DFC5B77CBEFA79F04CF4B57777C0FE1B9558E1667695953A70BB6E0B898ED7E4509FF35BD1AD692FD2DDCBCC1CF4A0F10719D2B3AACB1C8EC8DDF4471312032EA3A3D8543FBE11853B871AB8FC15EF24DFB2EBF8EB0994859799FFA324A6EF7BF2E808231531AC099CB13BB3F91289339C9FFA4A3597612BDC9985A20CA5C13120E00F6858A6FE169EAC60FA85F871869DD9D6270B1C952C5E7DCBA2F0FC8C00925AB6AD44161669F7F21C4BA7B33CECC07933DDB3FEAD47671605C42055C48C6C3DA587FEC3DE9F19090E2C5FC080193B6E869A28E370FA1767BBE64EC9958DFA06529B389E187EAEF0F70685A7D869AC9C8BCC2602FAF08256C1C7B773D60A472DB35BE49FF1FD8C5BB21D13909A10A2578171BE4BD7A573D494D7ED26ABF5F385F356D65EDB63551A157178B4673CB9C39299D94E6DE135E6DF8E901F0940DC888DFFACE6B33E70F7430AA8D9D98A0BB3C466F9A682C91F1A88115771DF81EFFB4D702BFD50D8C857D7BEC11879695FC9AA6FAAF217EA5FE4D0BCAB77C5DC48B80B5CFC5ACD0B38ABC55A0634666F009B37E5BA4CFF556A48FD91C86A9FCD36650F5BA56DFA0BFFA4608294083EFF33D8E8BA0CA083A7E655BF475F2EBAB073F08A870A1625AD4584FAB902FA28EA5D5E5025B490A7150E5C4BC39DD7B8E1990BDABDC44547105FD2AD17D508FAF20395D8C268E6F1001F3C4718E9CC62CFD2E32E897B6A921D15B870DFB09F9B3FC1CCEF4927149A7C22B688571BF4A3F59A3576DEA12BF2D43A265E2142335818DD20C33EFAFF023C27A1F64A2C425C20F31DBDBFD0CF6D746AFC4D2CFE2FECB43FE0C098DEE8862D658A8C88471E8AF7528372134AD9F8BC4480B425BFC7BE9C7F7EC6B1333C1D11ACD0CE4F9C23BF10CF7F429EDDBC87CA20E7CC8D2F874263F81E081BC1F22431ECB429FEEFEF8D197D91278F492035F642E206AFAF189D5B5BACE135265A65BC0E8331C97CB1E242C6543B2BA5187A16AEE1EB5E39C6C4A5DAF2065895B49AFDE7A3714BF9AFDA8A9534B492CFF51C72DF81854A1B399146B3A1F7DCF8E8346B1F85FC73CEDD5A13F6CCC7243E889E3A009C2F2B5B29A996F218469E8E58ED9BD2F87FFBC8C24AF70AE1ADC7251D2A74D9709E12900EC86BF024759F1732A9A42A303DE205F79882A50BDEB025979977155417D004CC29D40D27D103DD9C5FCF362F2D75EB02261AE52D664A9006FF86079ED38B74583F8E422AC6A9E928D20D17236329A2FD38D3AD6F832A582D108B001EFFDD341026FB8097A374BA8118F24D9D262A0058B00F30077E8E1AC96E3691C7EE0F94627E466EB4B36A4A0EFDAC9F4842F5F763B750251AB0F0C747281E26B872F86C3A58F55BDB47D5E0E66BB6DBBB1F973692528F4F7003D6FF7E678CC7318B6CB70FF78F7BEDE1249AFF086415B8CC09715085583BF9D9B65E89E0DB4D961DA7FB4CECE45DF45740D88FB129276F174F9BAA835C34E16207BE5BDE58E1E8C4599F1BAB723CDCA05D67925AD2DF6DC0EDD6882E7B63602AA3D7550A9846752E68E724F6133E433B84D91029C3A4C21AC4A14697C29693D5C7BD28E146FAE8C9BF452300AD7C028B51C763CF04BA5305E4728F9EE2227595DC2C3C7D0D60A1061758AACB3C5CFD3E0E8EB0B0D1214172E2F3D5B5D797ED0D3F30310283C3D3F5576858891A8A9CBD5F00B0D2326417174899CB3B5FCFE0000000000000000000000000000000000000000000000000000000000000916253542128409510040D9405620403620800481888880002521884000045103810C608BD02AF3D78266850B2B8C4B0F29363EAEE469A7E33524538AA066AE98980EAA19D1F10593203DA2143B9E9E1973F7FF0E6C6AAA3C0B900E50D003412EFE96DEECE3046D8C46BC7709228789775ABDF56AED6416C90033780CB7A4984815DA1B14660DCF34AA34BF82CEBBCF"

let test2_message: lbytes test2_mlen = assert_norm (S.length test2_msg_str = 2 * test2_mlen); lbytes_of_str test2_msg_str
let test2_sk = assert_norm (S.length test2_sk_str = 2 * skbytes); lbytes_of_str test2_sk_str
let test2_pk = assert_norm (S.length test2_pk_str = 2 * pkbytes); lbytes_of_str test2_pk_str
let test2_sm = assert_norm (S.length test2_sm_str = 2 * test2_smlen); lbytes_of_str test2_sm_str

let test3_mlen = 132
let test3_msg_str = "2F7AF5B52A046471EFCD720C9384919BE05A61CDE8E8B01251C5AB885E820FD36ED9FF6FDF45783EC81A86728CBB74B426ADFF96123C08FAC2BC6C58A9C0DD71761292262C65F20DF47751F0831770A6BB7B3760BB7F5EFFFB6E11AC35F353A6F24400B80B287834E92C9CF0D3C949D6DCA31B0B94E0E3312E8BD02174B170C2CA9355FE"
let test3_pk_str = "539577CB7F2088FBEDFF1B53F235D607321857DB32BBA645F8DF3A89DD4265526A828B29BA303B9DB4D22747002355FF739EBEDA9A2B65608B753D081F007997EAB3758BA5242191E26CC4742F1A3FAEAFD0976C72A925055001A3CBA58CEB065795010A7B001C35EF08642E9A65D8FE42B9E51E4C7C925B11F42239E39F12147EF249A678776B49C32AA31E35DE0A8B8A30F6376EDB2DE8CB87270DFF58B3F854151822B4BF5D87E2F59FE4EEDAC01093B11448B985E30236E0AF8A5758F7D5A814DF522FBA6C9EA1FC6496FF092FFF997D44B4C2C234D8D26AB4AEF66A0C110562A050DA5056A1E04E44234D6E84A0D0CF0F633DCD5FD796C38BEC3693CBE7FA594E2AA281C001F20218A32E7B3990AF2F7A3D533AFFF62AC95B2CE586804B13D5CCEF129655BC960700BB8A950C671F04CBC3B9C4533BB678FB5D0CC67309D2A9C7FDDC5D389638405033C9B821F51E02F252028944DA9C1F1E299B38E6A76EE4726314A582A4DBF2F8CE2A26D50E006639FC6E3D508BA3CB4DA4FFF9DEC5D9F81E26875820FBAADD479E834530789FCB0251F720B0E4DFEA266648D761145EDA06D506193640A602EF2567FAC75CC2F8C6A67CCB1DC6B322B0D6234E0480A79D32650EB888289FF4CEF07DA24AB44952461589B97347D8659AADE11B5C0DCFF01986CC499AECA33654E2D662400AD182961696728D38217948BF4B39226C8B98A314D30B22ABBBE1290E538BB03F8A4532C2E09D2B7CC765923A6205A4BE511C849DCC2E7E3DBA50635299792CAE10A1167FB737D2EC52A8F2E38D0605805F50449FA34CFDDE60EF21378C21CD5409FC6AE69BCB10931F836AB4C588F8E51E520C017F794CA9D35D418879E605282BE1C81A71BB1E025E25A131DFA580C76634D66793E5A9EFC0A444CD4A84E57CB415E14F1FC9A1B60AC75A265860C938665CA15DAE1D640DB38A997FA263C78B6626271EEA66BDAFFE5E1F78B4CCF47973BEFA9E05593E1BF6C5A30D320B5197358CB7B5D53AF4530946D5992DD6EAB381B6E07C09EDDC4D4507D519D6E92274DBA8317FA372772AF7873CC564A43BF227E370F37F639CA71BD284896AE74BBA0CF806911B6E9B9367A55C6441956EAC725CD3D230A09D19BD262F9E5E48D84AEF69B7A6507F262A0680B2FD28347A6C0C96BEF71B90AAB724EE7CE94FD8105004D56841F363D5E7433C12F259011E031055BA83DB46D65D097208962DFA1C908CAE4420B15896FA447704F7E4206F8D6287D2B9D48CC138C58B47B371DAF073EAD5F834C1A2F75CDABF7F513983FFDD0106EE0035C6FBF711B5C8D1F597EE67131CAA7E361D77B3870213754F8A661327462624CE0C5839979F06C928A175373056DA713FF9449CD62038044995D56B8E391BBFB486ACD208912A1D480A7D94F9F8BA6395A1F4C14BB18FF7C478774E786940411070C44C3D5E93661F0986D89DFFAED48EABA63B922D8B039EF142EC8448D485C34D3C1359505FF4FA7785D7C08EB1A3B38346CDB88EC31649B9A5EDD84801D065BDC7372928C349AC7A8CC1F80C5365BBB192DB255971AB0F88D4D705184B2F83E35B090B5549C2C4EFA490852F3C575B26A154FAE57F3ADD57ECB6E46803EC0A743B10002C9FC7679520D8C3A167273E4396F8E2D260EFD0CB7D976A7F9349736057FEBCBA883A47568BB7E1A0276DD4BC7A8EB4DB01FDD01D772D53628E22FDA6ED24B32A0A47A49DD4CCAF8EEE012BA2C8D37C78521F191040DA557861D52B3EFB7E647ED2BF9D67DCF7BE46A9FCE2AC29CD34566D41AAB41E10A1583792B9955511AFE4AD32EC2E1A37C41AF72EB005C839BE83FF712192F92728B6765BB8C4E3E4D65D728D54748336DB4E1676F32129E5FFC3BD4735873E89E4C8601284C8840FB94FC868DEC5821CB7777BDE5B574250658F06B1A60811CBA4CAFB1F026376E3A1EC641AF5FE7A21AF9FABEC5D78005B9A1D441682D3C27CBB41966775ACF89D72CAB3CE8B9B0ECF68E60640527B9E603A2F20952BBA021DD7E4E4D8695DE4F72275421560EC37A47169D3C05D8A206C033695222178BD4E"
let test3_sk_str = "539577CB7F2088FBEDFF1B53F235D607321857DB32BBA645F8DF3A89DD4265522CE995A46BCD9DE5599BA7C5D836B5D117A4E0782483E8FA179EB367E0E19FD9CC0664E0BEB43F4EB288B36E7D425A20EFBE29E282AEB174DA0C0B4FCE4978087C2D6453EB828319783E24E848D806F6A146A30644288787653813030266037030012838846141192886A627575869A8A380965164910A1529777450361A3A6941282175167A426010A4410A48422904294043941A38725193449344A36A99124519057444A576654A12414385280A141A9406017A9A79016A569357718A31164962562A885946269962321692A3A511823913061613704201989576A8734A9A11106A5733222970763094A55561013A1051889468778A810496997318A1739135A45906A315A82198080335428240067551053A85387377A82A7354AA69355225280A512886699039778826462881905681812A24079A29414100838022459740202A1941621415438178A7A078840507AAAAA1439229597A839409831010849367A61562744733882A9464A2084AA9418775A103932985115318364205305890016075086A9889671A0460244180A90A8199494515A6621580166A832501A278754453AA37846468AA37957A3869A06588057A7435063477277652817434432A5626129650502540458A4661055069360AA3733507520524398874A68513647974758323934A84045A371566AA5A39622724123564952859541A119365129A726120530345767A6976A53A15930029822905035865632352A8841080212622A2479A484565A829629253A7323797826A450208845067A2523060002301158674A79335241116A746214663A141310129068AA284257863731544010020099409AAA418709910102A5366995735077AAAA8246A20A2871967985686A7589524273AA50936868343016149881288A019395082061950011502918A893664781A78A398012071659A641202794951676481613A293275106712A89AA679A54429666273057808363830385004806374A88461996173A10915701A4920413689274A74819106680429511A922928274375451751442573473130090655A56397345876412510796AA809288601907A91167177266469126790927575A0090483798963955A036A1A968A272108A270155A4045A6A20126A714123A6A1A24369664440112850387075972A956A342298479A20578962275442A1408301798496548093261AA7A17269A2944183907977A75052320008108A79967A52674A67191718051455A240143613129344497539468583369610908450A83268938618617696A662802586506974293AA4A8330313850324723481408238868781386A63755A45442477028981A6740548376A057A129A800242844A7751A0419332802A1324442334024936935501500A8153671A57569AA50336A990481936A191764690A698529A18290736701788621933747045A065A782180448534270425124252982314049A9597496782A3034633A72A279813614444904800A3770682A506574A97531682A6263108883887777533354753A7893525136839818832306749128134A04A8366069708763257304A86803937A4305122A23783A70042593470659607326982093114748A3A8167199413134AA39A41155AA0201152069768A8967256187188275121A91866AA16A8A4814587A217A3403991A7420A830701609760A798388917A29AA76343815664923304DF6346CAA811CEF9D443D988C7E8501E9A34548608BB0DA3A347DD442BD3A4724DDE2F37194A3DF5885DFF7E8FF7A6F90C28BD0E56D47F110124CC1A920570F2C6A943965F470A1A7F0F82171E06FCF621558D5F934817C5F40F603C9131CF8018DF1BF97FDD135AE29C53D35036766F722FDA8A9A94625EEA19DF19463E06B567C0303208793319C57317BC158E286D61F08CB2F84870E42D87529F9D4690B31BD7CAC5F6DCE977DC52FFB5EFF3432E9D74A73BDBB94772FF3AA2F447641EF1626A8D302BABA6D45803BFE86754CF1256E3C39D7D9B786E2834CD0EF35A126D1D19529DF4734BCB722550AE28FFC86D28E247016ECFD4CE9BFC17E00F8D1AEDBC81908B4AEB42DFB7E2FE77E6515F3324057B65727BE0D9C446ADCD60CD3BE3458A86B6362CD426A334C9903AD09680CBD8EC4FE7480327D957E1334EDE6B57EA561E221C5D7ABB318F9DECC8F53282B56BE0424588F1499190FB3FB43AFCBC28EA383CC85530D0182D1032CA4E24FC4EB83D1388452528E213ECF808C629F28ACC90EE696C90208CDDF95083AE814B57BCB781405CEE867F7E343F234916ADDBFCC5D86289AE42D9D2318980C77C07368DFFFACD1581B351B946A736E292C2427EB507DC68D58C31680AE4C39849B2CE23FEB445E5BFE2858BBF77B34631004D626AF699C1F5FC09C443ACF8ABEE6BB26DD6188ECE4ECFB3B1B3997BACD06E1D546676E1FCFB8873F07198F5258558CC7427FDC702A82F040D32407AE7DA288B180281CFB2B1625DB6C651A017BD2ABEA62BF71D66DA01732FF86827587CD9FC8AB400E5083930D67695175F272918357BC3366DFAB0E38222586D9AD5FF74C4F790A56684B804FEC16353B93CC75A8D7FF651894B99433FAA9C110780FE1FBDCB2E61130D781DC2DBD14EE234893BAA9B3C9338EF155C629DB98688F58370C2D47AF14CBB31C9F78CCA6BB6BC79641F739E7CE9B9070609EA1FE7F8A207C93EDDB8D4A8762CF3F3D651BB48333812DD61E7C10580B4FBBF439072A8490C9BCC9DD50C8738AC012B4C708B632DBE1A4ACDBC2E6B65D0FB74FC20E65E9C77A6DE1E75BEBF733E79772C1CBDA672D151575911FCF608B7403426AA1E3E200538875D4B0E44356CD436A8842F3E010D04B1C4A319006239DAF7DD2F1E2B7BB50754A00399B596435494F97F1F758FF90445F8AC6CE1791055E8AEC4860E81D526CC1E4DA2177669473D45FE56FDABEA8FD75B494271754F9D59A99557240B32AF642B52CBE63A96D8706508E259D5FEF86DEA3CACB35EFD6AA9395AC6000ABD1A1EE233F30FFBDD6A35C0334E0AF1230F2E3343392E674F24D9129B2721C8E64415F884C09FC88DEFC08AC6C91BF3FE24D6144E1418B3878A5D5D5D10310203836BADC2580A7341DDFC009980691E0ED62F5ABCED3C631C3CC9831B4CED7CE4ECFA65B7471F434B9C6EE3050D9D00CA984AE1198955E5C422B372FEE78619A731A172B0F0906DD6608EEE4DF32A9C3891F3E251F7376C2FB321E61C22F9415B3E40E01D6F35A6588E47168159D2B03FB4302BC42DE9C283EBB38CB9C48FD9139E33209B67452F7E718539288760D5C10EC21DD34AB89F99DCAA76ECE76F87C43EB517A9BDDA9F38AD0191D7E56021868D0ED17EA2DBC5D22B12CF97675C2A20AC0F4658AF06C56A2095ABD10FE4A1BFC35BCC1DDFB794F7BD3CF2615B57EC9F6E71DCE9478C1D3EAA49677A813FD4858042122FC75B3D729AE62530EDC11D4626C1FBB9D2A12739E153ABD04CE0913EBC5D284A8B1FB2E36612713D92169CC4EB2D6311D6D498CA7346677BAEC3E56438464F78C92D43FBA4DC8D170152BFC7CE1613A29E339E563CB3A28FAEEE7E769A59109B1F2EC2B7D93B78F4BF7FCD6E31C1ED74F660D90775DA37BDF311B97BA0B7D0540A412E58BD6FFFB1C90A886BA69BD645050B8E0F0867448A5FBEEC7B05F903BC4B5E9572E2858365C0E996E9F8F4392A62FDF8281864EABD85BAD7A198FC34A63C0AD34E2ACFD31DFB4547191DC9113A9F86EE0BAF2E7B90F8F4030527B2041D9360446745DC05164E024699221AF1B5761BC2D6314D4EA736B862FD064E946C25D58290AFDCBD42C04ADF6E15700195EF27E0FB1D6046B72DA158D3E23CFC516B6F1E8878E60C691052306760B5A493B92B24D9A00090A2192229844C24DEF530C7B3762D8D19E7CD05029B08F89E8FB65BEF197ECAB9F482FAFE121C7AD5FAC9A826EC463610A94836FF62A6E75B3500C0D366D438F26DD516F3B8A76F9966856DC39C440E64BAA08C722493269B62A317CB11947A9A54A41313E66D04BA49DC62A5D445136558CA902279B569AEA644BEF152731A3101FCCC46767003914EF1E421576A85B43F5D8FFCD4356AF8ED14FC31D3B5EC4B7E618A4455B614F5695BA21D5DAA209C89D75DA36C8B8CBB2AE9EE7CF7F9D6051468034E33605686FF32BBE1D75977070B16F8798C8AEE8707E5327A646C1BCC0FC08C2104FA3C7B8B45285F56E28F0FECD7EC7E9A2A072344309F863BC236431C7976C0D026083DA800D6A8E35D47192030914F9CC3A022BC05AAF429839096F4BBD261656123A066762B7A7AF59C62413D4231DDFADF887A766CF89E773846793B01C10F7514A21CB0901C40F8574A8734780A32F18701774B8A354BD1CC7FB6B0BD2F7574CDC564CBB28EB9A219303F16DAA122C8B8CD4E3C5186092E6F15919E061A4D9EEF005B2FB91270A02C052813747DEA9A035B9416CC030A6A6FE00B4A9571175BABCCF947F20DF1D2E1CB3F695810F2DD40696C6AB677801FF11088263C8A7B1E03456274D1F30B24FF37777B5269BD20174CD14657B6CC4BF7343EA38AEFA1C4CFC4D21D678699D5552B7C9E799ED69FE3239B8B21A4E3F3EBE467BEF1A83EDA6267998B73F02ABFD29A3408A5726CA93C2C5257ADF37D800AD7A72F07621A41B3FE9B086FAA01D8F5A2A9756C29AB3414FC81825E6F8029AB51E61D095F2601C56A3784BB1E7F81845E91883F01C308B32F3D72FDDC4B982099158B8DA3014B3B054654CB21F2EA1FE53A7FDA4064AA4EEEDCB6BEF7900FA27D945179DBEC17C58AD6EB941E57E2DF3A8BAFE676489F7BC8420EFE0E7AF31A2285C9D5868F39C1FB4CB2495C64C8EF7B5644B8D0DFA6"
let test3_smlen = 2833
let test3_sm_str = "49D72E0F9E37720153B8988D8CC3F879CA70483DC236BD3AE9E55C372CAABC672FFE77674A18C04DCCD879E97A1C5A049AA4667BE3D26270B94247954DD02F571B2FFCF415C5FB948FC326BD38B8B20A434E92B779D7C1733A3E47203782C4E63CA97878E71519AA489F05C54E54B85B2E87E97B0CC3A4B9B818E14AD1749B77A168BA98914A33222B8D75A503AFEDDDAE3FD84DEFDC99EDDE6F730E0FDE6A36AB804827E93EDDFA8A11A79267EBDCF2519A788FD4378A5C2591EA8FBE80596E82D841209B8F3B56E76A165F8ECDB44350B12C1CF4FC1301E1141E2E1A8B8718C819BFC244B2531A436D19A052CD77B3F3EF8D444B316D28ED654EEB55F4DD684402465072B02600F3570A06C9298B7F20B41A211ECE780007980E17BEAD6D8D237BF85B512448574008B92178898F17326D156DAEB46AA7193940C94CA98ACBBB7101190C2EA10EBBA91ED9AB043F664EE1A3BDC43B754A0E6BD5051EBD063B02DC8D3D0A2DE8E86C840719E13681C844FAD64643086E386FEBA40819C86A0F666C4E4313D55367E6359C2D0A098C818F79B5E19E8B0BDCD2E0DDA9D4F8098D72A82EE755E593BEE9B9DCBFED2196E2462D853A60901F8AFFEE92FD95F15FBE61B6D95BD02604FBE5A55C7D880002C5FEFB9A60EFCD30F1DE2F212D59FE47CDEC29AD939093AE41CF96C831762DB134CAD675B6E494DB0766FCE9087F38E8B5CC02675209B29F83AD8D5F8B62B143F0DD478458E0542BCA47F21A1ADF1F09B8A57AD796FA3F1BFB3AE42E017FCA7E8FEC0ECDBCA13C09E58243F4B30EFBABF5C6381119CE3CEBD5240954A3EBE75405FCAB358036CDEBAE3B4311B4C23FD56C3B0038EDF689B99139B2C79D8170ABFD4EA8F7502AC99C16EAC060397B603A0DD782E992E3AC6CEB30B7D3C3B205A799D2ADECF88C89E255C9C1B83CD85D9E32702BEB62699F3A48422B88C6E0D4EB0B728C93AFEC1C00D7C0CC1C1DAA0E060273F8C68924D94F7CC91C873BB667A6510603342A40CF592DDB6172FC244E750C2699E7E2AA4C938EA3B961680210A87E3248FA74A1CE1BC91909F05452D3DB8EC305029D9DE77F79432F950CD0498FA34E1A4E80B800B4A499D0523A041D9FADD34CB24F9B1435FA4BFA1B309A1CDC552F9850B4A51550DC49FB7A112F0C333B43C68DC55E44C4990AB31FE452DE2AA745036CC6BC14652EB0B7B65CDC3700BDC0B7A4544FA2AA832B0B4781CF9E23FC5E97C94EE8959CF2F77D0AFD258CB99A1C33230D6FE59C3A347E88C166618728AF9799BF80DD3907F0EA2C8D228EEB31B4457F12109160EDBFC80709249DB26BCD97A40F980A2E232B0EF8C2AF2F7AA48296808D5F5AEC847524834DF083EDA77EC5285BE1404338F06836D729368F9A3A2038F86386288439D00896EB0186F0D9976F41022160D481AEE3F579214BDC5F3645F3CCBCCCEDB1F0AF91DB14763C2F6D90C42884AB9D2D567D07CEB86AFE17E9BB60C816F8F8CECEF1D86FE88549EB577C00F7F6B2DD4AAFEED0DD400B2CDDF3F237952A1A3DA4D553F918E32147FF77CBF348F8B56E00A01B2293E2C7457A75AA23E9CB6B1AC913C24CE783904BF2A3A04F719DC0DD9D5E392EA731DDE948F5CBE3B1910F4E0B29F4CA52BAAA0FBDB20D819F7AF9750A80761979BF539AF2CB7DCF2279B859FFE29BEFBEF0C4608D3592C55B8C0DD8F57E1BEC4332F82FACE446E5D4C96A5AAA8252441872DC5F90FCE5BA35DF6FD39C70DEE704BC28367FE43FBFCF74D67DF44B604FDC312DA5AD01376B666683EC552D694387F4DC23056C2F9320D45B07F51AB106CA6996D60824C105BFA60B781A6E0401CE1EFE8731C58A9DE4CE0936DC916B8246444BDF2F3F3B0B6C893C3C62CD58D08CDA99ABF6A757CC9414A3487192109DA7B8A29FD20787097A45D0B14980485119FC45725CBE90329833D076547D8FDE9518D248F7467D33BAA9FFE3C76E4B0781D15C612162AA69A938437343CDD8E7E0F7BEC094D568DAAD171752D8D73334E28725FEA31DA5BB4C1D63E654BF6E32A4D2F025F73B0E226439084D36DB9E8961626175EBEF295854950761CE1EFB901C28EE701EE8E693B01BE4A2B72D0691CE7C6ACB9A0F41210FE0AB2BC79F9976CF506DB2962C5B05439A5C5DE382C3E1501FD9415E920D5206F4742392C5E9F2E9284D65A1D40B1109AAD0168B3792F7D03F7B136518B4796C93443EAF2318AB011CE45A602A1D5E0AC1CF21AE45065C6E84EAFDBB7314A5F6116A11A4C4C6C897A6863E863D4FAAC0B024862A775F3FDFA04E33B0781A3D60D9BDDEE07FEF569475860CBED688586E9B1245BDBC208D74AD4F5072383DD7D273E42A1FED161F2BD1621905B01FE571815CAEF4DCA7AAB050740FC8C66BE034B41ABAEA18956DDA95455060187A064158729E5CB7115CBDA12F8AF079EF3D83E36CD7EA951EDAABD32C88B27A9B2BFA9DBB3704809E7A71057E6BCFD8C5F53AD64232CED0AE9C3A2072CA3A94651C163134AE3E960D3BEED1B7713BEB9CBD691F4DF84D39D174ABCC730728FD329ED44D71DEF56AFEC8C0F5115DC6A488CFD342BB4416A7CCF9C3C2E6F8B5DC9A57EE8A8941AD5C469C5EF9F8859875AB870E4F8941C12694C9C45EE2F1028170802C54C82CB7BEFFF816EAA2668D5F10A43F6C8DE020248961B9AB0DC16AEDF3364F7D787AF1B363FB2C28DCCD2AF94DCCAF32AD82CC45943DC92EEFEB0A9726AFCEA1AA3CE1BA3EAD67D1F47F9B5F547A276B6FE35B27D08D506CD61C8678BBE58D09C009F31294F0DE178099D13920B116633670FFE8910103ED5347BCB04DC3909D41468AE11D3A81249901E198E9D9A2C9ED03A6505681BF67A73E9807FE183E8991945D7BFAB8AF2A0726042FFF5375F8B68324D2B4D6D762186B01ADA1E62ECDC2CEAB206982F77A8A38355D6065928EF612411A3A11AC7A49F077F221927596FA25223E04ABC84E8C9CA4935C37BC1F5BF13B2FAA98627438106F401C0DC5998711665FB95CE2DF466EBEAD28E2677DE5B234007495C50B6CDC2D58FAC541FFA6D0AA86D247A915CBC07AC5B8D31D4BF7EC1800D85496EF59F67304D0CE944BFD56D879A1FFC306E75A96C3A7EE3FD78A177529B6416FD7CB1E151CCC23FD3585067F7324F94B7939185E8AD07C994DF1E9057C959F95827029595905055B4101B203E6B7C4980C5EBBB9F3F46D87DE09E7B6F0876F109C01B4E2409876875AD81FF0466476B741277B3EFA08528EE6DC6E04848278930F9349FF8F64A9B657B0D6FE369E88069F284B2208BF9FE8ECFC9807C7CAA2DEEBAF1A20F13DC3BD489DD810AA44D1AEE012B223F965D460266B40CD6AF6EF2D04CC2404F182D9C240142F756DC9B0C95967189A793D84A5A72AD96CB026747F896FD6FAF9E613720581D51C00C5A6DE1F0A92BC11CFE7E483B6CD712127587D78431CCD8A0BDF575783E732C6E26F2046E26504922B9D3687CBB8EB2B5DD21C698077B89ADA5E2070A99D4142A056403C741470E7343E0D55C88063C07AB97DC06A4D8DD62DCFF2AEA12A0CE1996AC263A1D3F693BFF67838FE2A83F559E61C23AD0565C10E6818BF565F9D1A7E46ABA130C5020C30919DA2A5CBE9F41C23265053696B878A9193979C9DB6C0C3D3D8E4F5FE01050C0D24334552657D86898B989BBDC1C9D3E9FA0A0B2B323B40417F9EB3EC0F141E24303C444765A8CFD1D8000000000000000000000000000000000000000A2035404D00E2102308A0A4828001E024462800012210C10A082011006A02A88082908895EF931570675A20082F7AF5B52A046471EFCD720C9384919BE05A61CDE8E8B01251C5AB885E820FD36ED9FF6FDF45783EC81A86728CBB74B426ADFF96123C08FAC2BC6C58A9C0DD71761292262C65F20DF47751F0831770A6BB7B3760BB7F5EFFFB6E11AC35F353A6F24400B80B287834E92C9CF0D3C949D6DCA31B0B94E0E3312E8BD02174B170C2CA9355FE"

let test3_message: lbytes test3_mlen = assert_norm (S.length test3_msg_str = 2 * test3_mlen); lbytes_of_str test3_msg_str
let test3_sk = assert_norm (S.length test3_sk_str = 2 * skbytes); lbytes_of_str test3_sk_str
let test3_pk = assert_norm (S.length test3_pk_str = 2 * pkbytes); lbytes_of_str test3_pk_str
let test3_sm = assert_norm (S.length test3_sm_str = 2 * test3_smlen); lbytes_of_str test3_sm_str

let test4_mlen = 165
let test4_msg_str = "1CDF0AE1124780A8FF00318F779A3B86B3504D059CA7AB3FE4D6EAE9FD46428D1DABB704C0735A8FE8708F409741017B723D9A304E54FDC5789A7B0748C2464B7308AC9665115644C569AE253D5205751342574C03346DDDC1950A6273546616B96D0C5ECE0A044AF0EDEFBE445F9AE37DA5AFB8D22A56D9FD1801425A0A276F48431D7AF039521E549551481391FE5F4EBFB7644D9F9782D83A95137E84EA3AEB3C2F8099"
let test4_pk_str = "2CA59C6CF33C53803749F69EF5ABFA9482FCEE7EFD87FBF17135ECC3FF3FD7F7692F5FB9CB14AD68C8CA02B0EDF1BAC39D6B109E4F13A3F983B0A6A46BCDC4525296FCAD5E57C072B26739FF910676C4A2604E2E026EED7E56C9DEB16524FAE96E3C3A5EA975894DB5A02B531FB1190FFCA6E531432364D84E222027A333F8B06705E03A1A98264589518F24ED975020A809AE59CF7CD761708B68C6E3F251E6ACF96C1EC8FDF9283E9448DDB730E654F573CDA9F2E6DED896D15734D7F32C10E70BCB01524BBF86D428FA7CCA1EC8D8E52C552A40AF9933C17EBDB837A4F377F052F9BA8C9862FB6B50F253E4550BB00385845C5BFE201EFB7B0C8094A9BAF99B263F51218A92E36E469C1811D2B861B90F5309CFB694150EDFFF39056526C6B67B4A172549DE27520EAE18E195936192799466BD63186AE8594BAB486DC13F2F94EC02793F7576C9E2811EA3AC344B3A67E39E7A1005104D27FC72E378220B83E526E760B5B5CAA006347DAF041505230B92B28760039D6BBDDF4FDF63DFF252BBE5932D49666ED093A270FA6A2BB136B0325744EA66C54BF1D4402EF86E6EB5CA1D6F876A262B6844FAFF0AB0EE00242F98D92273D3A6DDD6D689321AF6A2D4E9B95583EC07FCB6F1EDB178E509466FBEE79075C558E13CE15968ECE2B79759AEB3A7406B65CF58EF2D5E456ACFF66C14C6CC793C463D4BB086AEA219AEE765512EAE4218279D22598098B26A7778AD02BE0736FB85AAF35ECE392D9EDDC9F0EBBA2A00254FB4BAD2C9F53095D48BF205F0C43DE2990546E130ED4426F2A4D81098D5F45A57D37341BF8ED1E75685E6EDF3BCE4D5693584DCB706DA5CCF03704BC0640A2A937E58D9739D2467904D96A72884E1FE555B62579B90CFAFA184FEA4B255C156F304FD66750FA650CDB4EB69E8FC1BB0C1CD4C9B0C6CD33A0B57667DF6056FFD54DB34F5B65F0B52D9B7F690F86002D999797969525ED7625AF12C8FFAADDA6D7D489FFDD979285F1535F82DA45EEA2E1278894AD8973A8BD6377117CEECFD5180D9351254A76D38A8491B3D78D9E88FB0AFFEF2D2CA4D87D645F8F2E2C8C6124386CFCB148154087E3DC7BDAF07A3205D10591CB0C610406B3E4FE375211434BBA02D99D3F6AA485D9339ACB99712E0D872886B2EDFA2B293D4DB012C1D738A2FBAA2FC66831D0FD72E6A4DA53ABB087A5B4D0F0C3149E9C4C1984C5006C996DB077BFA0E03A0A9368F000DAC5AE64CC26519290286C2E1E4958A9A9DF67D795D472E6341D164405D2204D76B1FC5E75551E0416071B68CECB34B57652BCAFE33F9D817B7466039874726B29D731757A83A16806533165516B59CD444BAD14EE02FF6BC1E61724BE199AB60716C1525D2039F13A71D50FE1E5A0AD8A34D4C556DCD6B9ABD01AD1F0062EC03226E0372E54D1BCA899763B73441653347952BC58ACFAE90B6C84E5EFC0224BDBF9617C8EDC92FD515EE56BF88F393E45A48F39E253C0B1951D5BFA3F4348BD8A8E15FF2322789786910500F12490927B32A40642A5BF397DA97254355A4CB714168CDDDF2233FA12934773DB15BFDF857F27E71F472E00B46F853477A63201D3FF2DFA07B62C1C8A54EF41437099152D0420B14547FB94309C71C48C5A753B90ADE3B32B3BFF72ADCB21D34F538BB00B7AECDC7C147B6C5C7CEEE2732A5558D64ED221E1B323BE996D4AEF7DC09669AAEA76DD793541D9B05643C4A4E52FE2E839B39C5F9F3698117FD744CB3B7CF1F7D6933A6893088C7B735BC2473B198A4AE0F9C74ED7351FDAA0A92375B0F8E895FC396D1BB13730242AF5767E4A8E71B86F63C82E528BA2DE48F7E04323BFCDF4195B3471562811C1DC39617E9DB9711351E7E73E0BFFD6E185B8C2C4754B6B63A7F19A02D2B9F2BE279F19FD9D3465BC25E4438CFFFFDEC2D9D41ED9477C51ADE5D5811023B29574DF5061133DF3355004B1C154D73D31CBF6DB17E45DC20E947B2E33B46345759B3683A5665C90F9F3DA6CD0F016DCBE20F999EA17CD1F58F4B9E8A78C10ED45EDEC74773244D9CCA94C6C807E6E5E9A9ED618AFB63F7"
let test4_sk_str = "2CA59C6CF33C53803749F69EF5ABFA9482FCEE7EFD87FBF17135ECC3FF3FD7F78A55FB0A533616AF95AE292F6C6BDCDE36CE5E9DB7154129213F678F5AE93985E1A36ADFA0DFC628E8E7BD607F7CCDFCEDAFFCF60623DCD1E37ADEB9222B34C85C16E22AE9971480A7B7408F01E79C29107AA8A07A04683313064261526A26208486A2886435667618A57057073568470137699158AA3934483806800748854368232AA3739A5A50267A128686A006A97691616442A2539827357187A84209247056477A658AA07639478923192A271006346605A7728125021919A40A7433A4499184538260118726A50976662255457352A1A338858589A05A84794043511853408A86070296384391121733844736725AA722346A85A31015A98096780A50771332A923744A299006497A68414042439458238738908264A4774854A2166A903012249923025915A33732721892335825425A285245699857192A92171A93A4341459AA78320045AA7A40AA0A802272331672046A45A90545838666943711A8027888007579A1177636633372270A10886439314786A797468264A3265424825665670A6052191177460961452952292AA5A232079076496A6081646024A234495415604682646690580AA1128836A523A96995A10129A6A5291054934311147115352289253220A197847641A5A2A19980713A858399A6609235033A4357891194A7872111661138A14248A240AA08333439779216515596260978A30196A572A76100A771568710515783108294532243A33841815488A75568AA973958014125335A45830602944A863510393150044A44599A13302AA27313082178409663496096592691241624430A44412735586588925AA3855623050163A224A638A2756974063796A7342467222187297142226238236633280503935430526019A88078701363724981888374A09486683062337A325750240A341375A370AA1106081401A032464093A1005A4A517056689A5736958849367287949257A46A0AA02209357806A4188369318417838691748026753A9032889968A1393079655831443092A75292655681095956A1016A48926468638320197838202773225300A38308AA07122792A41803313A03A264280760558367A055029166317A505652A06861A9264A435AA5AA84A692768111436380189A999AA67935207795750A69072694A23213488AA8281949727992621448112AA84987756397829AA5163831932AA25270A302719500049515483102388314036680456978070A963A2745202477A53A1759456A4434957492777A111090057A82212698836475404567687494254676140131282785645176957840762716976883A047667549936641A415219513009010952A5723246044868321978767570781128329129A160048918AA53A0811A21272426465379392808A2430122122062377607A341386AA5376446879135362A6806873A9597388723107963A631336A157607182689028A5863A60A476096884A09952A4547424A6121641412374148346A75081815A083844339609021979A68730175429A95A5A58806301478A3050145430801989883822076444103A1423A4AA07566204A9AA4605422747805517200569A456A50075909A94362A118715304433961800A56016A4A989136348844769401A70053932806172A118A86537734340A9326311AA466646397323013A41400374936239958933943861609025538000771944979223060FBBA08F1BCF1740C7706C22EC864983BF3D763A49E75DBF30BB9C738478ABFAC9A44AE724018FFDE2EDECA89D506620B4DF58A2C285DE7CD2CABBD2CEEBC0C65CD7E927BB0242EB0FAD4A21087824E1547782B2360D7BA2AE6EC3E63A20EB93D7E55299AF6546CB3D132AD60043CE3CCAA693051B754BA419EA8737CDF7FA50B031F19A4006811C98AA3D2FBB7F40D0EF885F0540CA9E6BA9A06B1B3758664A00E9E188396F23BBD1406C6FC67B917883E8C03FA81EF7A9BD72B86937EFF9467EEFABE0BAB4B9DF0FC18361405E6466485F176E870C855F4AF87428BA4A497F044BC04A3AC6B83FDB9A56111BA4B5014BDE1A4D2C576A0D2B433B54316D3C502A26A5B99DB13996237BDD8283C94D47DB9149FC8C88CD9146C778F03FE2E1989BE9F1F49EAE7516EAECDFC101B525BDE83B1C21698003DC3BC7BA8A111B450C3E0ADB73B1F16368B0A1A3D99A4F71EC9237C89E655081947DADAAA966E3A97842757F0F6C0516CF6A386863ACEA427FB1A21C1E85B5AF385AF21ECF17AA300C4B2CB707ED44227FACC05642A2E32FC8550E20B4C9028E906DCA7BB95F205C070B2341CEBE935EBA1AB51840D7D96F9B54DF4F0D9380712A4817FC494B9BBBE74BBC1476E8F9CB3DFA1E24C91F2A7704407CD6726CC2BBA0E32B598AE9C52BE316284CF951065C3AD95DDEC40E29791ADCC336A17BB378554636BD9CB0EFDD0FD3EB3C552E989D265EF7D6B566EBBDFE3FFA7C3984E88F8B039CD94DC59E04028CEE34272EC09332BF7C7861CD3041A830A25B239ADE9100ABCE8325852BD3485A0F8E84462E02437EDFCB129638A506782B5C2207F817AA6D9FE229ADCDF9921D2380A80E63B1428B260AC3C02C7D81A655791C34178D0861D9CFACDFC5D75359A2479A595B867CAD11EDF9768AD53412BA6620C91B6019C6753105B8E645F8E56D0AED00884272C25E02B4277BD5B2D1EFC8B32350DAF51FEC74F7AF805B773E642021023DB1C042FD71E0E489A2E4337405E33A0B4DCDB3F18C9719A0A88198A8B430CA171E96D80D87B27E2796E617641A75CF071C84CF47CBC16EDBB42C8FA1CD6C1072521D1FCEFED584C9AD903FB7EAA51443C3E1627612D442859AF3A358484F6C648B68FB40C7E659E160125F9B4934391758FBA887AA31D2E412A3BB05660D51F7BE6105A33ED249CC6A18F1A824E9FB164BBDEBA095266E853D6B7F67DB7792DAE80395D69ABCEF420A3950C5CDFDCD464103D16DC431CF8A3BF29F48F26600EC6F9418F1FFF2CFF69B417710392BD710D594DE32A763350955A02373E653C549D8C5CA3653252CBE0DC01BC4DFE4B6A183CFC8EE66365E809EAA743D813F72C71D8CEA98DA1AE5B4E8F975F2BF1771FDD0CD48A486311578850822416DD048F7D36F462133553F190A3BE40CD718D7D63410E9ECFBEE59BC49D2CB3671DC3DACF162D77FCC5901838682990116C19C543EB8ED46A6A2258F552A0E2E0E322461D8E328A1F45AF7FBDCA0DD8FC628DE7AB01D2402686357A6E1C852AA852F5B98FAA62A05D345E7478836BEF69AC6491376AC0AE23FB8CAC4ADEAE3721F06D392F723B3B3F891BA6907E42B16843AFBB1928AC8D1164A081CC2995AB449B7B6B2C07DE4F19FA56714665E79FD8F662510B471F64C9D4EEC32603C5F8CBC554E20CA1E69C2530F38CC3D76F59B724D1382612014B2E543A8766B5FF8BE83ABD84A800BC0F05F5CF4B245F51E91080768F3D4689D82FCDAD6B9609349D6020E8A1AC3B1A679C7ACF76751D6D0C8D3546FE614055C004CE3F26CC38C5E98D1D7EE93DC23181166FE3BF9FA67E10390F2853DD5A2F04282F17E15EEC2A641FF802B76233CD6F56AA12DE096F00D11EBF11ECA1B0A2A0051B710D228BC753746AD1AADCC03A4ACDED6FCDCDC51B16B786A923C3D88BAE39BC09B7597F1FBB32960DBD447B3C8B5D7C8BF682AD06994689BE24381E79D8537125CF46BA270C698D9C40F96C50576A7E3E7FA5A30FD0C3CFC08CA535A1BC14686EDF844DEE264A7774FE9CAD740803F81F2A573F43284E97DA78479F0B6C6899716C7DD68AC945D506234CC0FB271FC6500D6FF0F26109F10FD172FE419439E5C36B380786839081938D10E50F26A5BA5548A57BE9709CA84AA12F1ECF0CCFDFAB805250E874A7F4C80656DA617CFF9DEEC7CC7968E17377D381EF84A3D5B28BEB9EF6A4DCD179D39C1FE065E4838FB80EE733429A5A2128A23FE6999AEF79C98A376F97F1FE694208A00B92D92573269C850E78A48D65F46ADCA7E00713D50E8B1CE7225D07D6486F0C06C5FA40380CC0BA6142C118E9F562020055159CA557D5D603BFFE86C223768D3F1AFD85ACF97AB223FE9A640D5C3BEC066C07B564C6E609EEE462F4498FCB6DDED6AA355DFAAAA0C2235B8F2427B36D451D521BE0125005B28E8C25D059F9CEDA4D7BD52E554E2DF058E0237E9C110BAE4C47C7125F70326704911AA8EB578C2D4ABD307ED4203F4347F39769E22A0B39386EB3BC125BCA9666A7AE70D9E45CCB2D66A325A0EB5B2F7AE03D443098D271DF4D871219754955BD3D73DAB3FB62A7186D6E74E9AEB6B85DEF2DFA37F57977B2B914B46A2DF9A0364B69D4479C85FF0C223E807210DA76DE882D80A2DFA57D2760BCE766AC947312328198A7DB234669AAF9FE35A1B585B66AF005921ED262B3C8D5DBD45CCF535B3F27C3EC1C73A7B643F4B36193F2D885968C142F09D924A8E358C8426C99E04A5BA41AE4344BD9B59CF794943111192E11A56977EED625E02C7E1620A97F8147481FB77D5F24C50EAAF7872D1EDF05BF82ABA252910933C575A9E02AEDDCA2E137E972AA06FE8C6C31FAE6B1756CDE9AF2B3D2AC7D1D9C054E17EFD6696B965F640D6B52DD9028023960850F5DC283F30A68DCE7A59250A263FE28EA47EA72F47A8B325A9C51FB53A9674E6929C1AEFC00D568A3B017E201AFF0243EACBA30E93B69799136311BF95B5E36C15777C2ADFD3E782B37806B9E5EF3732C58DA9C975DD3849A9828DDB8D740423A4065238C7D1FE0E6AA0F2CEB06791EA8121406EAF22DF35A04197317E52A6A58165104DE27D47E625708FF1DF4A436D582C8F8F6D70C3EA96E673AF3DDB3ECC40592C9EFC891BBDC1304972CA2B0D784B8A764A"
let test4_smlen = 2866
let test4_sm_str = "433099F298F370CD350F602C81E44EFD22517775FF46F2294E8644C4ED78F9CCA23BFA232A8F29EA0AEBE18855F00A7D4370EF10B98F9637D3DFA3EC0C394DFFB52C0637DE61651746464F4087D3FA0AFF5BB3DCC180813B5C25C76AC53F8AA0DFEF8F30975CCF1B14FD7361102AAC85105A78801ECDD9E92B545F61D10D3DBD98B1E4146AD6F4948069911EA65F13CFA4C0F035639C1657C1EE7147174210799FE6C11612765C253CAF1F0723A5340D2E8077D44B2FBF90BAE33E36A8B729303752051741D14EC2097B77091E818641F2F465FBD6008CCBAD6DF88B036355FA5AD41849764A3BB5D603D6F6442401379451331C7202DD821E517A573AE9C6E285AC8A28BA919EA6F83CFD65FB947F5C79EB229E1F1B2A71C69256E08CA0080AA736C34F6717F83D28B866679AAF4D60B63223285DE46D283DFDD216C13282A7D056280CD7B74FF1A0CF9657FA59A5A3AB45545C95ED6E2A83253F241517B6E891B0B286FDA8FA81DC1B5F2E16A471D61DB8739C053915B0836030D41AA09E2378A942258033FB385CE0798047642693DD28A7FAA095324E29B56B089005170CB8EEFE803613A9F089675ACD1B4E49F0DA1E95164AC3EFB2A630FDBFB1ACB3B0B7CC85F4922CB7D726E1F09B8B5D158C3AE0BEEF9F0AB91E7D3FE40E0BE09125D8E03C37876C8156FE4256EECC4429A176005A25BFBB68529CA41DBAEFAAED423C15C7A3597D4E3E84BED6E487B50265D3F3DC732F02512DF093BAF32B3F4F44BEEED4FF5ED0604B3F045A8931294B15F4C82A0CC4830358F17CB5DB7504873CDC15D12042547BF6E1B58143C7EEBC887BB8EC9D8635418196FE609368DB4334052B6011847BA2B7DC8F13B117A84982C58596A3627F32ED1D09A5A16E025E60E4B7652320C1BA9BBC20B028EEFC940AB6F34C97F53DA4D1B097B77901255C9FBB65C83078EBBF312E2D12648167F9F59E9DF1BDAAD24874D3B840BCC65379DCBC4BFEA0AF4E0FCFD4115E57A8D3C43C8BC14417B13D17873CCF528FCF4BE7EB0781BE6F66AA8EF623B7C70C73565D90D13F40A4352D9B8FE677AC361B2A6E5F00F741776764EC359135DF88C56E63FA865407BAA4DC04675F2F5C741A8629BA997D158607A0368FCC448528BCC42E5B77A5FEA2CF3C6721E7AD084F3CE8C8577ADA8C8115618B7F5A367354E34B01B496BFC2331BF59FB1D11AA73D44D2E2B13CF0000FA8CB8187764C9AD23315C405BA649E50950F77EDAE05405A30003BEDD14D877E343D590F8480579A2E74A4ABB26B5A820307A4B9CB46CF47CB0808285B44BABA3016ED4A758D4BD762F6C3F79EB26E5EC17D0F18D16DEF32E126E525AB3FB04BFF2C1E8D2A122B71847A754E0BABFD30898397A74C9588C7C1649AF90E99852C58E6E6022322866D53B3612EDDB6FF247F12B99882997C1C24786FECFEFFB1D213110712EA92DF3A6A17E1C6FF2A8E75DE46BF52FCF4FDFD0B182713F5D84C9AE4A0E87FAB10E436E8159321DB7436C9BA4B08BCDE97F55DBB93C019A9E2910D795498831ED722068804D091E069CCD15100CB526267729D3FB6066F46A913927EE4C780E04305CD8EFCAFBB53C84DB15629294C2CFF76CD4696A890BB006637690828052255459C61BFD84C65BD9A57F14E09E393085CEE7C9288A8AB35A8FDDE1D0F2B9056707CFBD94B032CCD1C9A08D0252DD63BFBEE11F8626BFD88A9E501162D94B67BF0E96DBEC8505D34E2DEB44F8E0DBA03DC005EE78CCCE84F16BF9A9E59D6A00BFF302F77A9114B81143F53C97F019FC4CC7D7614AA5C69022D405D4462CB78A82D3CB148D0D7164D9D8DB6A2D10DEF239793D1890136EAE6A644E7A2D47E533CBDAB5DC81288725D70BBB4288E5531BBCBF6D86827CB66A94B9143E0F8CA6FCE551D67FE1BD13A96C3709BB555C3AC043614CA4A62C0B7597A8A34CE5B29C638DCB00CED9281D5E31E4ABE396FB116936C318F64CC5D37DDDE4DAFBE65176A22D957370FAB1DCACC841EC83AB573754EA66380F12A8D57D0579C2795BAD4F30C3A222244D2EAA9D24A6DECE78DDA9E59FA7C102B8279A49D152850740BABCB0B85C23A09D016E8ADB7AB78AB63E813F72763A81ED31FC776CD41E118D2DD4386FBFA283304429D0055CD1734F3C501B006381244DFED78CA5C27FD7995FAD7B772A9099BF45818280929CBDCCAF9C1045C208601F0D1ACCBBC75AC287DDD76B1C1F4ECA5ADFBFDA2B838385190239581830FE1E33F2E886CB655FD3F7C614C8BA41BC7A79E53882418E6B66B1CF0C147ECA73339C29A21BD53E860493309A5276D91537DC58CDCCA8AE63361DDE1085BE60CA3667DE75A3957E0177DD0FDD59FC7C810E414A8E08400B9C9A5253A9047F8E6E7D09BD0404F4FCC6B716DF854DE39700A015771C86121AB154704387BDDDC1D004BA88CBA86C052E40AAC7710BE631964D64BE9DD8DF004D83D61586D6D2F22C776353751493560B95DEC902B27CAA5050296347959F4BA46A8498AE25363E2D648CF34FE8EC662B52FC34A8AE4A3CA809394EC1EA07DC10BCEFA99C2EC967A208F9C47B91082B1E0DB0EC183D631195465D10E9F274975F9AF47EBA407403ECEEF5D2E0B542401A5A4442ED17A0FB0FF1DB2005DE70C43342967B54D954A5D76D4E567BC5AD277F7B2C02F581F2284C7FC8E3D7681278985A946784C18BC1A38D80C79050A339CC01AD0060EEE5DECEA52BCF69CB48B9AD46D03D37451C4EB4FA10F4A94F83315E9C9A488CADAF9A0721C19A1E434EFDE5A48402CE05E4AF598D383B687F223FAFCF980A734411ACC3721B6B4323612C578A85717021008510DF8EC261F17885F40EA1EC2509B4FB40F9A8DEB39D27277A2882D0A6CA5980324FD7FEC871A9418E02ECA0FBB99BE2D7B3122ECD6C81A8142F984197E3F53F8DD265E1D9472437B2C82D0FB463CE6EB6A3C506D018FE0404FB0C4B330329853A1FEF9F7B95983C91836FF11C185A2CF7A94278EEA9742E9E31D003A98359C367BF55AE86AD5057F26AFDBA0580F57042B64CD14EBB93B4FBA245F707505FB9AAF2FEBB19A2DE4588DF81A8A0833E8D794420A64EF19C29FCF3A9B3BBF40C939934AEA0DD83A87F11C61DA7E7265EDE5DEF78787933BBDF3026FDC2DCC822BF1B732130B1A56DA49F9A4EB6D122010369BF6C66B85732C6C8DCD0E5EB04BB90DBB6CD3C918128522DB52300008E19665392C52E31FA6D96CEECE91A20FEC3148816EF18390E84A7E08043340C68A7F6C795B58B4C56C593272988063932BB61776FB58C8A1EC1E189527B6ED55286A3E362F810E751CC6B83001AF675B0E48193989F91B261574B26B3872E748B0481E13670C57CFFB246107EEC71CA411329C21FC8A821EF2710771E36BCA0337035530BDC62759770A8D06337AC3FE8A62A70FA4E2ABCC752AA7D3EF72413A312FF9B18D138EFB326071AEAED34D41ABD3795969F9D218A946D517997593C7498E5BF377FD1ADBDDA5458ADEE734E27057809C4AF90BE087415711D3C2F780FF5DB2DBD6E083A2302D8FEA6E3FC183CB3FC4A1DBE7A018B6F79F3DE61E44955E46189F00485C02C94CAC83FD9CDB78EA6BA101A1DFCD000510182034364D587C95A0A3A5B3C0DEE4F5F805060E182A2C4647578FA408284C6F738BA4B7BAC2CD0E101B2C3C3F4B4D707C86878A9FB1B3BFE0FC172436537F808C90A0ABB9CBE800000000000000000000000000000000000000000000141F2A3D4AD204439E8079000142486601018A24100808804000408840001A00816171000F9C1045E7D28216011CDF0AE1124780A8FF00318F779A3B86B3504D059CA7AB3FE4D6EAE9FD46428D1DABB704C0735A8FE8708F409741017B723D9A304E54FDC5789A7B0748C2464B7308AC9665115644C569AE253D5205751342574C03346DDDC1950A6273546616B96D0C5ECE0A044AF0EDEFBE445F9AE37DA5AFB8D22A56D9FD1801425A0A276F48431D7AF039521E549551481391FE5F4EBFB7644D9F9782D83A95137E84EA3AEB3C2F8099"

let test4_message: lbytes test4_mlen = assert_norm (S.length test4_msg_str = 2 * test4_mlen); lbytes_of_str test4_msg_str
let test4_sk = assert_norm (S.length test4_sk_str = 2 * skbytes); lbytes_of_str test4_sk_str
let test4_pk = assert_norm (S.length test4_pk_str = 2 * pkbytes); lbytes_of_str test4_pk_str
let test4_sm = assert_norm (S.length test4_sm_str = 2 * test4_smlen); lbytes_of_str test4_sm_str



(*************************************************************************)



let to_stdout str = IO.print_string ("echo to stdout:\n" ^ str ^ "\n")


val print_seq: #t:inttype -> #l:secrecy_level -> n:size_nat -> s: lseq (int_t t l) n -> ML unit

let print_seq #t #l n s =
  let rec print_seq_inner (s: lseq (int_t t l) n) (i:size_nat) : ML unit =
    if i < n then
      (IO.print_string ((string_of_int (v s.[i])) ^ " ");
      print_seq_inner s (i+1))
    else IO.print_string "\n"
  in print_seq_inner s 0


let print_int n =
  IO.print_string (string_of_int n);
  IO.print_string "\n"


val foreach_ml: #a:Type -> n:size_nat -> s:lseq a n -> (f:a->ML unit) -> ML unit

let foreach_ml #a n s f = repeati_all_ml n (fun i _ -> (f s.[i])) ()


val test_sig:
    mlen: nat {mlen < 100000}
  -> msg: lbytes mlen
  -> pk: lbytes pkbytes
  -> sk: lbytes skbytes
  -> sm_ref: lbytes (mlen + crypto_bytes)
  -> ML bool

let test_sig mlen msg pk sk sm_ref =
  let sm = sign sk mlen msg in
  match sm with
  | None -> (IO.print_string "failed to sign message\n"; false)
  | Some sm -> begin
    if not (lbytes_eq sm sm_ref) then 
      (IO.print_string "signature incorrect\n"; false)
    else
    let sig = sub sm 0 crypto_bytes in
    if verify pk sig mlen msg
      then true 
      else (IO.print_string "verify failed\n"; false)
  end


#set-options "--fuel 2 --ifuel 2 --z3rlimit 800"

let test () : ML bool =
  let t0 = test_sig test0_mlen test0_message test0_pk test0_sk test0_sm in
  let t1 = test_sig test1_mlen test1_message test1_pk test1_sk test1_sm in
  let t2 = test_sig test2_mlen test2_message test2_pk test2_sk test2_sm in
  let t3 = test_sig test3_mlen test3_message test3_pk test3_sk test3_sm in
  let t4 = test_sig test4_mlen test4_message test4_pk test4_sk test4_sm in
  if t0 && t1 && t2 && t3 && t4 then
    (IO.print_string "Dilithium: all tests passed\n"; true)
  else
    (IO.print_string "Dilithium failed tests\n"; false)


